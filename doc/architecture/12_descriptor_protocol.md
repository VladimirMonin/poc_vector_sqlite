# üé© Descriptor Protocol: –ú–∞–≥–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∫–ª–∞—Å—Å–∞

> –ö–∞–∫ `Article.search` –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ–±—ä–µ–∫—Ç —Å –º–µ—Ç–æ–¥–∞–º–∏ –ø–æ–∏—Å–∫–∞

---

## üìå –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä** ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç Python, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –∞—Ç—Ä–∏–±—É—Ç—É –∫–ª–∞—Å—Å–∞.

–ö–æ–≥–¥–∞ —Ç—ã –ø–∏—à–µ—à—å `Article.search.hybrid("python")`, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–µ–µ:
1. Python –≤–∏–¥–∏—Ç –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –∞—Ç—Ä–∏–±—É—Ç—É `search`
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ `search` –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–º
3. –í—ã–∑—ã–≤–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `__get__()` –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ ‚Äî SearchProxy –æ–±—ä–µ–∫—Ç)

**–ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è:** –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä ‚Äî —ç—Ç–æ "–≤–æ–ª—à–µ–±–Ω–∞—è –¥–≤–µ—Ä—å" –≤ –∫–ª–∞—Å—Å. –°–Ω–∞—Ä—É–∂–∏ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç, –Ω–æ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–≤–æ–π –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–¥.

---

## üéØ –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫ –∫ –º–æ–¥–µ–ª–∏?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —É —Ç–µ–±—è –µ—Å—Ç—å –º–æ–¥–µ–ª—å —Å—Ç–∞—Ç—å–∏:

```python
class Article(Model):
    title = CharField()
    content = TextField()
```

–•–æ—á–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫. **–ö–∞–∫?**

**–í–∞—Ä–∏–∞–Ω—Ç A (–ø–ª–æ—Ö–æ–π):** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –ø—Ä—è–º–æ –≤ –∫–ª–∞—Å—Å

```python
class Article(Model):
    title = CharField()
    content = TextField()
    
    @classmethod
    def search_hybrid(cls, query):
        # ... –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞
    
    @classmethod
    def search_vector(cls, query):
        # ... –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞—Ö–ª–∞–º–ª—è–µ–º –º–æ–¥–µ–ª—å –ø–æ–∏—Å–∫–æ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏. –°–º–µ—à–∏–≤–∞–µ–º ORM –∏ —Å–µ–º–∞–Ω—Ç–∏–∫—É.

---

**–í–∞—Ä–∏–∞–Ω—Ç B (—Ö–æ—Ä–æ—à–∏–π):** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä

```python
class Article(Model):
    title = CharField()
    content = TextField()
    
    search = SemanticIndex(
        core=semantic_core,
        content_field='content',
        context_fields=['title']
    )
```

–¢–µ–ø–µ—Ä—å:
- `Article.search.hybrid("python")` ‚Äî –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü–µ
- `article.search.update()` ‚Äî –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ß–∏—Å—Ç–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ: –º–æ–¥–µ–ª—å –æ—Ç–¥–µ–ª—å–Ω–æ, –ø–æ–∏—Å–∫ –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚úÖ –£–¥–æ–±–Ω—ã–π API (–∫–∞–∫ —É Django)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

---

## üîç –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞

```mermaid
sequenceDiagram
    participant Python
    participant SemanticIndex
    participant SearchProxy
    
    Note over Python: 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞
    Python->>SemanticIndex: __set_name__(Article, 'search')
    SemanticIndex->>SemanticIndex: –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö—É–∫–∏ –¥–ª—è –∞–≤—Ç–æ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
    
    Note over Python: 2. Class access: Article.search
    Python->>SemanticIndex: __get__(None, Article)
    SemanticIndex->>SearchProxy: –°–æ–∑–¥–∞–µ—Ç SearchProxy
    SearchProxy-->>Python: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç SearchProxy
    
    Note over Python: 3. Instance access: article.search
    Python->>SemanticIndex: __get__(article, Article)
    SemanticIndex->>Python: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç InstanceManager
```

---

### –§–∞–∑–∞ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞

–ö–æ–≥–¥–∞ Python —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∞—Å—Å `Article`, –æ–Ω –≤–∏–¥–∏—Ç –∞—Ç—Ä–∏–±—É—Ç `search = SemanticIndex(...)` –∏ –≤—ã–∑—ã–≤–∞–µ—Ç:

```python
search.__set_name__(Article, 'search')
```

**–í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç:**
- –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —É–∑–Ω–∞–µ—Ç —Å–≤–æ–µ –∏–º—è (`'search'`)
- –£–∑–Ω–∞–µ—Ç –∫–ª–∞—Å—Å-–≤–ª–∞–¥–µ–ª–µ—Ü (`Article`)
- –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö—É–∫–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ (–æ–± —ç—Ç–æ–º –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤—ã–ø—É—Å–∫–µ)

**–í–∞–∂–Ω–æ:** `__set_name__` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞, –Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏!

---

### –§–∞–∑–∞ 2: Class access (–¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å)

–ö–æ–≥–¥–∞ —Ç—ã –ø–∏—à–µ—à—å `Article.search`, Python –≤—ã–∑—ã–≤–∞–µ—Ç:

```python
search.__get__(instance=None, owner=Article)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `instance=None` ‚Äî –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å, –Ω–µ —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç–∞–Ω—Å
- `owner=Article` ‚Äî –∫–ª–∞—Å—Å-–≤–ª–∞–¥–µ–ª–µ—Ü

**–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
return SearchProxy(core=self.core, model=Article, descriptor=self)
```

`SearchProxy` ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å –º–µ—Ç–æ–¥–∞–º–∏ `hybrid()`, `vector()`, `fts()` –¥–ª—è –ø–æ–∏—Å–∫–∞.

---

### –§–∞–∑–∞ 3: Instance access (–¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç–∞–Ω—Å)

–ö–æ–≥–¥–∞ —Ç—ã –ø–∏—à–µ—à—å `article.search` (–≥–¥–µ `article = Article.get_by_id(1)`), Python –≤—ã–∑—ã–≤–∞–µ—Ç:

```python
search.__get__(instance=article, owner=Article)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `instance=article` ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç
- `owner=Article` ‚Äî –∫–ª–∞—Å—Å

**–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
return InstanceManager(instance=article, descriptor=self)
```

`InstanceManager` ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å –º–µ—Ç–æ–¥–∞–º–∏ `update()` –∏ `delete()` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏.

---

## üìä –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

| –û–±—Ä–∞—â–µ–Ω–∏–µ | `instance` | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –ú–µ—Ç–æ–¥—ã |
|-----------|------------|------------|--------|
| `Article.search` | `None` | `SearchProxy` | `hybrid()`, `vector()`, `fts()` |
| `article.search` | `article` | `InstanceManager` | `update()`, `delete()` |

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:** –û–¥–∏–Ω –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –≤–µ–¥–µ—Ç —Å–µ–±—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞!

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü–µ

```python
# Article.search –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç SearchProxy
results = Article.search.hybrid("python tutorial", limit=10)

# results ‚Äî —ç—Ç–æ list[(Article, score)]
for article, score in results:
    print(f"{article.title} (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: {score:.2f})")
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º:**
1. `Article.search` –≤—ã–∑—ã–≤–∞–µ—Ç `__get__(None, Article)`
2. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `SearchProxy`
3. `SearchProxy.hybrid()` –≤—ã–∑—ã–≤–∞–µ—Ç `SemanticCore.search()`
4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ ORM –æ–±—ä–µ–∫—Ç—ã

---

### –ü—Ä–∏–º–µ—Ä 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏

```python
# –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç—å—é
article = Article.create(
    title="Python Tutorial",
    content="Learn Python programming..."
)
# ‚Üë –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ save()

# –ü–æ–∑–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞–ø—Ä—è–º—É—é –≤ –ë–î (–º–∏–Ω—É—è save)
Article.update(content="New content").where(Article.id == article.id).execute()

# –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º –≤—Ä—É—á–Ω—É—é
article = Article.get_by_id(article.id)
article.search.update()  # ‚Üê __get__(article, Article) ‚Üí InstanceManager
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. `article.search` –≤—ã–∑—ã–≤–∞–µ—Ç `__get__(article, Article)`
2. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `InstanceManager(instance=article)`
3. `InstanceManager.update()` —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —á–∞–Ω–∫–∏ –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ

---

### –ü—Ä–∏–º–µ—Ä 3: –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–Ω–¥–µ–∫—Å–∞ –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –ë–î

```python
# –£–¥–∞–ª—è–µ–º –∏–∑ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞
article.search.delete()

# –°–∞–º –æ–±—ä–µ–∫—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –ë–î
assert Article.get_by_id(article.id) is not None  # ‚úÖ –°—É—â–µ—Å—Ç–≤—É–µ—Ç

# –ù–æ –≤ –ø–æ–∏—Å–∫–µ –µ–≥–æ –Ω–µ—Ç
results = Article.search.hybrid("python")
assert article not in [obj for obj, score in results]  # ‚úÖ –ù–µ –Ω–∞–π–¥–µ–Ω
```

**Use case:** –í—Ä–µ–º–µ–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –ø–æ–∏—Å–∫–∞ –±–µ–∑ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è.

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã

### 1. **–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∂–∏–≤–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∞—Å—Å–∞**

```python
class Article(Model):
    search = SemanticIndex(...)  # ‚Üê –û–î–ò–ù –æ–±—ä–µ–∫—Ç –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
```

**–ù–ï** —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `Article()`. –≠—Ç–æ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç!

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:** –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ (builder, core) –æ–±—â–µ–µ –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤.

---

### 2. **–ù–µ–ª—å–∑—è –ø—Ä–∏—Å–≤–∞–∏–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—É**

```python
article.search = "something"  # ‚ùå AttributeError!
```

**–ü—Ä–∏—á–∏–Ω–∞:** –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ä–µ–∞–ª–∏–∑—É–µ—Ç `__set__()`, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—Ä–µ—â–∞–µ—Ç –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ.

**–ó–∞—á–µ–º:** –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –∞—Ç—Ä–∏–±—É—Ç–∞.

---

### 3. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –Ω–∞ –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏**

```python
class Article(Model):
    title = CharField()
    content = TextField()
    summary = TextField()
    
    # –î–≤–∞ —Ä–∞–∑–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–∞!
    search_full = SemanticIndex(content_field='content')
    search_summary = SemanticIndex(content_field='summary')
```

**–†–∞–±–æ—Ç–∞–µ—Ç:** –ö–∞–∂–¥—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –Ω–µ–∑–∞–≤–∏—Å–∏–º, –Ω–æ –æ–±–∞ –ø–∞—Ç—á—è—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –º–µ—Ç–æ–¥—ã `save()` –∏ `delete_instance()`.

**–†–µ—à–µ–Ω–∏–µ:** Class-level registry –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –≤—Å–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ö—É–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ (–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤—ã–ø—É—Å–∫–µ).

---

### 4. **–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ —Å type()**

```python
# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞
TestModel = type('TestModel', (Model,), {
    'content': TextField(),
    'search': SemanticIndex(...)
})
```

**–í–∞–∂–Ω–æ:** Python –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑–æ–≤–µ—Ç `__set_name__()` –¥–∞–∂–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞ —á–µ—Ä–µ–∑ `type()`!

**–í—ã–≤–æ–¥:** –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤–µ–∑–¥–µ, –≥–¥–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–ª–∞—Å—Å—ã.

---

## üé≠ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º

### –ü–æ—á–µ–º—É –Ω–µ `@classmethod`?

```python
class Article(Model):
    @classmethod
    def search_hybrid(cls, query):
        ...
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –º–µ–∂–¥—É –ø–æ–∏—Å–∫–æ–º –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏–Ω–¥–µ–∫—Å–æ–º
- ‚ùå –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å `core`, `builder` –≤ –∫–∞–∂–¥—ã–π –º–µ—Ç–æ–¥
- ‚ùå –ó–∞—Ö–ª–∞–º–ª—è–µ—Ç –∫–ª–∞—Å—Å –º–æ–¥–µ–ª–∏

---

### –ü–æ—á–µ–º—É –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å?

```python
class ArticleSearch:
    def __init__(self, model):
        self.model = model
    
    def hybrid(self, query):
        ...

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
Article.search_helper = ArticleSearch(Article)
results = Article.search_helper.hybrid("python")
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
- ‚ùå –ù–µ–∫—Ä–∞—Å–∏–≤—ã–π API (search_helper –≤–º–µ—Å—Ç–æ search)
- ‚ùå –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å

---

### –ü–æ—á–µ–º—É –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä ‚Äî –ª—É—á—à–µ?

‚úÖ **–ß–∏—Å—Ç—ã–π API:** `Article.search.hybrid()` –∏ `article.search.update()`  
‚úÖ **–ê–≤—Ç–æ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è:** –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞  
‚úÖ **–î–≤–∞ —Ä–µ–∂–∏–º–∞:** Class access ‚Üí SearchProxy, Instance access ‚Üí InstanceManager  
‚úÖ **SOLID:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

---

## üîó –ß—Ç–æ –¥–∞–ª—å—à–µ?

–í —Å–ª–µ–¥—É—é—â–µ–º –≤—ã–ø—É—Å–∫–µ —Ä–∞–∑–±–µ—Ä–µ–º **–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è**.

**–°–ø–æ–π–ª–µ—Ä:** –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–∞—Ç—á–∏—Ç –º–µ—Ç–æ–¥—ã `save()` –∏ `delete_instance()` –º–æ–¥–µ–ª–∏, –≤–Ω–µ–¥—Ä—è—è —Ö—É–∫–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç **–±–µ–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤** (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Django signals).

‚Üí [13. Method Patching: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è](13_method_patching.md)

---

## üìö –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã

**–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä** ‚Äî –æ–±—ä–µ–∫—Ç —Å –º–µ—Ç–æ–¥–∞–º–∏ `__get__`, `__set__`, `__delete__`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –∞—Ç—Ä–∏–±—É—Ç—É –∫–ª–∞—Å—Å–∞.

**`__set_name__(owner, name)`** ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è Python –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞, –ø–µ—Ä–µ–¥–∞–µ—Ç –∫–ª–∞—Å—Å-–≤–ª–∞–¥–µ–ª–µ—Ü –∏ –∏–º—è –∞—Ç—Ä–∏–±—É—Ç–∞.

**`__get__(instance, owner)`** ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –∞—Ç—Ä–∏–±—É—Ç—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω—É–∂–Ω—ã–π –æ–±—ä–µ–∫—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

**SearchProxy** ‚Äî –æ–±—ä–µ–∫—Ç —Å –º–µ—Ç–æ–¥–∞–º–∏ –ø–æ–∏—Å–∫–∞ (`hybrid`, `vector`, `fts`).

**InstanceManager** ‚Äî –æ–±—ä–µ–∫—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ (`update`, `delete`).

---

**–ü—Ä–µ–¥—ã–¥—É—â–∏–π –≤—ã–ø—É—Å–∫:** [11. Storage Layer (Phase 2)](11_storage_layer_phase2.md)  
**–°–ª–µ–¥—É—é—â–∏–π –≤—ã–ø—É—Å–∫:** [13. Method Patching](13_method_patching.md)  
**–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é:** [00. Overview](00_overview.md)
