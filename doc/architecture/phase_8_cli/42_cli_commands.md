# ğŸ“š Episode 42: CLI Commands â€” Operational Interface

> *"A good CLI is invisible â€” it does what you expect, when you expect it."*

## ğŸ¬ Previously

Ğ’ [Episode 41](41_cli_architecture.md) Ğ¼Ñ‹ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ğ»Ğ¸ **ÑĞºĞµĞ»ĞµÑ‚ CLI** Ñ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ¾Ğ¿Ñ†Ğ¸ÑĞ¼Ğ¸ Ğ¸ ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ğ°Ñ€Ğ½Ñ‹Ğ¼Ğ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°Ğ¼Ğ¸ (init, config, doctor). Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ **Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğµ Ğ»Ğ¾ÑˆĞ°Ğ´ĞºĞ¸** â€” ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ²ÑĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ.

## ğŸ¯ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°

CLI Ğ±ĞµĞ· Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ñ… ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ â€” ĞºĞ°Ğº Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒ Ğ±ĞµĞ· Ñ€ÑƒĞ»Ñ. Ğ£ Ğ½Ğ°Ñ ĞµÑÑ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (Episode 40), ĞµÑÑ‚ÑŒ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ°, Ğ½Ğ¾ Ğ½ĞµÑ‚ Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ³Ğ¾:

```
âŒ semantic ???        # ĞšĞ°Ğº Ğ¸Ğ½Ğ´ĞµĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹?
âŒ semantic ???        # ĞšĞ°Ğº Ğ¸ÑĞºĞ°Ñ‚ÑŒ?
âŒ semantic ???        # Ğ“Ğ´Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ?
```

## ğŸ’¡ Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ: Three Core Commands

```
semantic ingest <path>     # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹
semantic search "query"    # ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ
semantic docs [topic]      # ĞŸĞ¾Ğ½ÑÑ‚ÑŒ ĞºĞ°Ğº ÑÑ‚Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
```

Ğ­Ñ‚Ğ¸ Ñ‚Ñ€Ğ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¿Ğ¾ĞºÑ€Ñ‹Ğ²Ğ°ÑÑ‚ **80% use-cases**.

## ğŸ“¥ Command: ingest

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    semantic ingest                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CLI Layer           â”‚  Core Layer                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚  â€¢ Path validation   â”‚  â€¢ SemanticCore.ingest()          â”‚
â”‚  â€¢ File collection   â”‚  â€¢ Document creation              â”‚
â”‚  â€¢ Progress display  â”‚  â€¢ Chunking + Embedding           â”‚
â”‚  â€¢ Error handling    â”‚  â€¢ Storage                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```
Path â†’ _collect_files() â†’ [Path, Path, ...] 
                              â†“
                    _create_document(path)
                              â†“
                    Document(content, metadata, media_type)
                              â†“
                    core.ingest(doc, mode)
                              â†“
                    Results + Rich output
```

### Media Type Detection

```python
def _detect_media_type(path: Path) -> MediaType:
    suffix = path.suffix.lower()
    
    IMAGE = {".jpg", ".jpeg", ".png", ".gif", ".webp"}
    AUDIO = {".mp3", ".wav", ".ogg", ".flac"}
    VIDEO = {".mp4", ".avi", ".mov", ".mkv"}
    
    if suffix in IMAGE: return MediaType.IMAGE
    if suffix in AUDIO: return MediaType.AUDIO
    if suffix in VIDEO: return MediaType.VIDEO
    return MediaType.TEXT
```

### Dry-Run Pattern

Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ğ´Ğ»Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ â€” Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾ **Ğ´Ğ¾** Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ:

```bash
$ semantic ingest --dry-run ./docs/
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ” Dry Run â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²: 43             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  ğŸ“„ doc/01_overview.md
  ğŸ“„ doc/02_search.md
  ğŸ–¼ï¸ doc/assets/diagram.png
```

ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ²Ğ¸Ğ´Ğ¸Ñ‚:

1. Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ±ÑƒĞ´ĞµÑ‚ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ¾
2. ĞšĞ°ĞºĞ¸Ğµ Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ñ‹
3. Ğ˜Ñ… Ñ‚Ğ¸Ğ¿Ñ‹ (Ğ¸ĞºĞ¾Ğ½ĞºĞ¸)

## ğŸ” Command: search

### UX Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  $ semantic search "rate limiting"                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®â”‚
â”‚  â”‚ ğŸ”€ Ğ“Ğ¸Ğ±Ñ€Ğ¸Ğ´Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº: rate limiting                    â”‚â”‚
â”‚  â”‚ ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²: 5                               â”‚â”‚
â”‚  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯â”‚
â”‚                                                          â”‚
â”‚  â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚
â”‚  â”ƒ #   â”ƒ Score   â”ƒ Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº           â”ƒ ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚       â”ƒ â”‚
â”‚  â”¡â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”© â”‚
â”‚  â”‚ 1   â”‚ 0.923   â”‚ rate_limiting.md   â”‚ Token bucket..â”‚ â”‚
â”‚  â”‚ 2   â”‚ 0.847   â”‚ resilience.md      â”‚ Retry logic...â”‚ â”‚
â”‚  â”‚ 3   â”‚ 0.512   â”‚ api_design.md      â”‚ RPM limits... â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Score Color Coding

```python
def _format_score(score: float) -> Text:
    if score >= 0.8:
        return Text(f"{score:.3f}", style="green")   # ğŸŸ¢ Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ
    elif score >= 0.5:
        return Text(f"{score:.3f}", style="yellow")  # ğŸŸ¡ Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ
    else:
        return Text(f"{score:.3f}", style="red")     # ğŸ”´ ĞĞ¸Ğ·ĞºĞ°Ñ
```

Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ **Ğ±ĞµĞ· ÑĞ»Ğ¾Ğ²** â€” Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑÑ€Ğ°Ğ·Ñƒ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾.

### Search Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  --type vector    ğŸ¯ Ğ¡ĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾ ÑĞ¼Ñ‹ÑĞ»Ñƒ    â”‚
â”‚  --type fts       ğŸ“ ĞŸĞ¾Ğ»Ğ½Ğ¾Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ (Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°)    â”‚
â”‚  --type hybrid    ğŸ”€ ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· RRF (default)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“š Command: docs

### Ğ¤Ğ¸Ğ»Ğ¾ÑĞ¾Ñ„Ğ¸Ñ: Built-in Documentation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ—Ğ°Ñ‡ĞµĞ¼ Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ?                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ offline                                    â”‚
â”‚  2. Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ²Ğ¼ĞµÑÑ‚Ğµ Ñ ĞºĞ¾Ğ´Ğ¾Ğ¼                       â”‚
â”‚  3. Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ¸Ğ· Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğ°                         â”‚
â”‚  4. ĞĞµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Topic Structure

```python
DOCS_TOPICS = {
    "overview": {
        "title": "ğŸ“š ĞĞ±Ğ·Ğ¾Ñ€ Semantic Core",
        "content": """
        # Semantic Core
        
        Production-ready Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° Ğ´Ğ»Ñ...
        
        ## Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚
        ...
        """
    },
    "search": {...},
    "ingest": {...},
    "config": {...},
    "api": {...},
}
```

### Rich Markdown Rendering

```bash
$ semantic docs search
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ” ĞŸĞ¾Ğ¸ÑĞº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚
â”‚ â”ƒ            Ğ¢Ğ¸Ğ¿Ñ‹ Ğ¿Ğ¾Ğ¸ÑĞºĞ°                  â”ƒ â”‚
â”‚ â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› â”‚
â”‚                                             â”‚
â”‚ ## 1. Vector Search                         â”‚
â”‚                                             â”‚
â”‚ ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ ÑĞ¼Ñ‹ÑĞ»Ñƒ Ñ‡ĞµÑ€ĞµĞ· Ğ²ĞµĞºÑ‚Ğ¾Ñ€Ğ½Ñ‹Ğµ ÑĞ¼Ğ±ĞµĞ´Ğ´Ğ¸Ğ½Ğ³Ğ¸. â”‚
â”‚                                             â”‚
â”‚ ```bash                                     â”‚
â”‚ semantic search "Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº" -t vectorâ”‚
â”‚ ```                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

## ğŸ¨ UI Layer

### Separation of Concerns

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  commands/ingest.py    â”‚  ui/renderers.py          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°         â”‚  ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ              â”‚
â”‚  â€¢ Ğ¡Ğ±Ğ¾Ñ€ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²         â”‚  â€¢ render_ingest_summary  â”‚
â”‚  â€¢ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Document   â”‚  â€¢ render_search_results  â”‚
â”‚  â€¢ Ğ’Ñ‹Ğ·Ğ¾Ğ² core.ingest   â”‚  â€¢ render_error           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Reusable Progress Components

```python
# spinners.py

@contextmanager
def progress_spinner(message: str):
    """ĞĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ (ÑĞ¿Ğ¸Ğ½Ğ½ĞµÑ€)."""
    with Progress(SpinnerColumn(), TextColumn(...)):
        yield

@contextmanager  
def progress_bar(total: int, description: str):
    """ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ (Ğ±Ğ°Ñ€)."""
    with Progress(BarColumn(), TaskProgressColumn(), ...):
        yield

class ProgressTracker:
    """ĞšĞ»Ğ°ÑÑ Ğ´Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ĞµĞ² Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°."""
    def advance(self): ...
    def update(self, status: str): ...
```

## ğŸ§ª Testing Strategy

### Ğ§Ñ‚Ğ¾ Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Unit Tests (49)                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Command help (--help)                                 â”‚
â”‚  2. Input validation (missing args, invalid values)       â”‚
â”‚  3. Dry-run mode (no side effects)                       â”‚
â”‚  4. Media type detection                                  â”‚
â”‚  5. File collection (single, directory, recursive)        â”‚
â”‚  6. UI components (imports, basic rendering)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ§Ñ‚Ğ¾ ĞĞ• Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ² unit-Ñ‚ĞµÑÑ‚Ğ°Ñ…

```
âŒ Ğ ĞµĞ°Ğ»ÑŒĞ½ÑƒÑ Ğ¸Ğ½Ğ´ĞµĞºÑĞ°Ñ†Ğ¸Ñ (Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ API key)
âŒ Ğ ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº (Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² Ğ‘Ğ”)
âŒ Rich output (Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹, Ğ½Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹)
```

Ğ­Ñ‚Ğ¸ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸ â†’ **integration tests** Ğ¸Ğ»Ğ¸ **e2e tests**.

## ğŸ”— Ğ¡Ğ²ÑĞ·Ğ¸

```
Episode 42 (CLI Commands)
    â”‚
    â”œâ”€â”€ Uses: Episode 40 (SemanticConfig)
    â”‚         - API keys, db_path, search settings
    â”‚
    â”œâ”€â”€ Uses: Episode 41 (CLIContext)
    â”‚         - get_core(), lazy initialization
    â”‚
    â”œâ”€â”€ Uses: Episode 7 (Data Flow)
    â”‚         - Document â†’ Chunks â†’ Embeddings
    â”‚
    â””â”€â”€ Uses: Episode 4-5 (Search Types)
              - vector, fts, hybrid modes
```

## ğŸ“‹ Summary

| ĞÑĞ¿ĞµĞºÑ‚ | Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ |
|--------|---------|
| **Ingest** | Path â†’ Document â†’ core.ingest() |
| **Search** | Query â†’ core.search() â†’ Rich table |
| **Docs** | DOCS_TOPICS dict â†’ Markdown render |
| **UI** | Separate layer: renderers + spinners |
| **Testing** | 49 unit tests, dry-run friendly |

## â­ï¸ Next Episode

**[Episode 43: Queue & Worker Commands](43_queue_worker_commands.md)** â€” Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ‡ĞµÑ€ĞµĞ· CLI: `semantic queue status`, `semantic worker start`, graceful shutdown.

---

*"Three commands to rule them all, three commands to find them,*
*Three commands to ingest them all, and in the search results bind them."*
