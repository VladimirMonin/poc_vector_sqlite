# üîÄ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ gemini-embedding-001

> –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Å–º–µ—à–∏–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –∏ –∫–∞–∫ –±–µ–∑–±–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ –ø–µ—Ä–µ–π—Ç–∏

---

## üìå –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–ú–∏–≥—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤** ‚Äî —ç—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥ —Å `text-embedding-004` –Ω–∞ `gemini-embedding-001` –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (sync –∏ batch).

–≠—Ç–æ **breaking change**, —Ç—Ä–µ–±—É—é—â–∏–π –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

---

## üéØ –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

**–ü—Ä–æ–±–ª–µ–º–∞: –î–≤–µ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –º–æ–¥–µ–ª–∏**

–ü–æ—Å–ª–µ Phase 10 –≤ –ø—Ä–æ–µ–∫—Ç–µ –æ–±—Ä–∞–∑–æ–≤–∞–ª–∞—Å—å —Å–∏—Ç—É–∞—Ü–∏—è:

```mermaid
graph TB
    subgraph "–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"
        A[Sync Embedder] --> B[text-embedding-004]
        C[Batch Client] --> D[gemini-embedding-001]
    end
    
    B --> E[(–í–µ–∫—Ç–æ—Ä–∞ 768D)]
    D --> E
    
    E --> F[‚ùå –ü–æ–∏—Å–∫ —Å–ª–æ–º–∞–Ω!]
    
    style F fill:#ff9999
```

**–ü–æ—á–µ–º—É —Å–ª–æ–º–∞–Ω?** –í–µ–∫—Ç–æ—Ä–∞ –æ—Ç —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π **–Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã**.

---

## üîç –ü–æ—á–µ–º—É –º–æ–¥–µ–ª–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã?

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç

```python
text = "Python ‚Äî —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è"

vec_004 = text_embedding_004.embed(text)   # 768 —á–∏—Å–µ–ª
vec_001 = gemini_embedding_001.embed(text)  # 768 —á–∏—Å–µ–ª

similarity = cosine_similarity(vec_004, vec_001)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: -0.05
```

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

| –ó–Ω–∞—á–µ–Ω–∏–µ similarity | –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç |
|--------------------|--------------|
| 1.0 | –ò–¥–µ–Ω—Ç–∏—á–Ω—ã–µ |
| 0.7-0.9 | –ü–æ—Ö–æ–∂–∏–µ |
| 0.3-0.5 | –°–ª–∞–±–æ —Å–≤—è–∑–∞–Ω—ã |
| ~0.0 | –°–ª—É—á–∞–π–Ω—ã–µ |
| **-0.05** | **–•—É–∂–µ —Å–ª—É—á–∞–π–Ω—ã—Ö!** |

**–í—ã–≤–æ–¥:** –ú–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–µ "—Å–∏—Å—Ç–µ–º—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç" –¥–ª—è —Å–º—ã—Å–ª–∞.

---

## üìä –í–∞—Ä–∏–∞–Ω—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç A: Breaking Change

**–ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –Ω–∞ `gemini-embedding-001`**

```mermaid
graph LR
    A[–í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã] --> B[gemini-embedding-001]
    B --> C[(–ù–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä–∞)]
    C --> D[‚úÖ –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç]
    
    style D fill:#99ff99
```

| –ü–ª—é—Å—ã | –ú–∏–Ω—É—Å—ã |
|-------|--------|
| –ï–¥–∏–Ω–∞—è –º–æ–¥–µ–ª—å | –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è |
| +10% –∫–∞—á–µ—Å—Ç–≤–æ | Breaking change |
| –ü—Ä–æ—Å—Ç–æ–π –∫–æ–¥ | Downtime |

---

### –í–∞—Ä–∏–∞–Ω—Ç B: Dual-Model

**–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π**

```mermaid
graph TB
    A[–°—Ç–∞—Ä—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã] --> B[text-embedding-004]
    C[–ù–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã] --> D[gemini-embedding-001]
    
    B --> E[(–°—Ç–∞—Ä—ã–µ –≤–µ–∫—Ç–æ—Ä–∞)]
    D --> F[(–ù–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä–∞)]
    
    G[–ü–æ–∏—Å–∫] --> E
    G --> F
    G --> H[Merge —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
```

| –ü–ª—é—Å—ã | –ú–∏–Ω—É—Å—ã |
|-------|--------|
| –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –°–ª–æ–∂–Ω–æ—Å—Ç—å x2 |
| –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è | –ü—É—Ç–∞–Ω–∏—Ü–∞ |
| –ù–µ—Ç downtime | –î–≤–∞ –ø—É—Ç–∏ –∫–æ–¥–∞ |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–í—ã–±—Ä–∞—Ç—å –í–∞—Ä–∏–∞–Ω—Ç A (Breaking Change)**

–ü—Ä–∏—á–∏–Ω—ã:

1. **–ü—Ä–æ–µ–∫—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–∞–ª–æ
2. **–ö–∞—á–µ—Å—Ç–≤–æ –≤–∞–∂–Ω–µ–µ** ‚Äî +10% –ª—É—á—à–µ –ø–æ–∏—Å–∫
3. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** ‚Äî –æ–¥–∏–Ω –ø—É—Ç—å –∫–æ–¥–∞
4. **Batch API** ‚Äî —ç–∫–æ–Ω–æ–º–∏—è 50% —Ç–æ–ª—å–∫–æ —Å gemini-embedding-001

---

## ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å

### –í –∫–æ–¥–µ

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `embeddings.py` | DEFAULT_MODEL ‚Üí gemini-embedding-001 |
| `config.py` | SemanticConfig defaults |
| `embedder.py` | –î–æ–±–∞–≤–∏—Ç—å output_dimensionality |
| `pipeline.py` | –û–±–Ω–æ–≤–∏—Ç—å default |

### –í —Ç–µ—Å—Ç–∞—Ö

| –¢–µ—Å—Ç | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| Integration tests | –ù–æ–≤–∞—è –º–æ–¥–µ–ª—å |
| E2E tests | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å |

### –í –¥–∞–Ω–Ω—ã—Ö

| –î–µ–π—Å—Ç–≤–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| –û—á–∏—Å—Ç–∏—Ç—å chunks_vec | DELETE all vectors |
| –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å | Re-embed –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã |

---

## üìã Checklist –º–∏–≥—Ä–∞—Ü–∏–∏

**–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**

- [ ] Backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [ ] –û—Ü–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å changelog

**–ö–æ–¥:**

- [ ] –ò–∑–º–µ–Ω–∏—Ç—å DEFAULT_MODEL
- [ ] –î–æ–±–∞–≤–∏—Ç—å output_dimensionality=768
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
- [ ] –ü—Ä–æ–≥–Ω–∞—Ç—å CI

**–î–∞–Ω–Ω—ã–µ:**

- [ ] –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –≤–µ–∫—Ç–æ—Ä–∞
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**

- [ ] Migration Guide
- [ ] README update
- [ ] Changelog entry

---

## üéì –ê–Ω–∞–ª–æ–≥–∏—è

–ü—Ä–µ–¥—Å—Ç–∞–≤—å –¥–≤–µ –∫–∞—Ä—Ç—ã –º–∏—Ä–∞:

- **–ú–µ—Ä–∫–∞—Ç–æ—Ä** (text-embedding-004)
- **–ì–ª–æ–±—É—Å** (gemini-embedding-001)

–û–±–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ó–µ–º–ª—é, –Ω–æ:

- –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏–∑–º–µ—Ä—è—é—Ç—Å—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç
- –ù–µ–ª—å–∑—è –Ω–∞–ª–æ–∂–∏—Ç—å –æ–¥–Ω—É –Ω–∞ –¥—Ä—É–≥—É—é

**–ú–∏–≥—Ä–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ—Ö —Ç–æ—á–µ–∫ –Ω–∞ –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É.

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

| –î–æ–∫—É–º–µ–Ω—Ç | –¢–µ–º–∞ |
|----------|------|
| [21_batch_api_economics.md](21_batch_api_economics.md) | –≠–∫–æ–Ω–æ–º–∏–∫–∞ Batch API |
| [50_batch_api_implementation.md](50_batch_api_implementation.md) | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Batch API |
| [02_gemini_api.md](02_gemini_api.md) | Gemini API –æ—Å–Ω–æ–≤—ã |

---

**‚Üê [–ù–∞–∑–∞–¥ –∫ –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](00_overview.md)**
