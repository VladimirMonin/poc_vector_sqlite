# üß† Episode 47: Chat History Management

> –ö–∞–∫ –Ω–∞—É—á–∏—Ç—å RAG "–ø–æ–º–Ω–∏—Ç—å" –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

---

## üìå –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ Phase 9.0 —É –Ω–∞—Å –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞—é—â–∏–π RAG-—á–∞—Ç. –ù–æ –∫–∞–∂–¥—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:

```
You: –ß—Ç–æ —Ç–∞–∫–æ–µ RRF?
Assistant: RRF (Reciprocal Rank Fusion) ‚Äî —ç—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è...

You: –ê –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å FTS?
Assistant: ü§î –ö—Ç–æ —Ç–∞–∫–æ–π "–æ–Ω"? –ú–Ω–µ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞...
```

LLM –Ω–µ –ø–æ–º–Ω–∏—Ç, —á—Ç–æ –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ –ø—Ä–æ RRF —Å–µ–∫—É–Ω–¥—É –Ω–∞–∑–∞–¥.

---

## üéØ –†–µ—à–µ–Ω–∏–µ: ChatHistoryManager

–°–æ–∑–¥–∞—ë–º –º–µ–Ω–µ–¥–∂–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π:

1. **–•—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é** ‚Äî —Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π user/assistant
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–µ–∑–∞–µ—Ç** ‚Äî –∫–æ–≥–¥–∞ –∏—Å—Ç–æ—Ä–∏—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–∞—è
3. **–í—ã–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é** ‚Äî —Å–∫–æ–ª—å–∫–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏ –∫–∞–∫ –æ–±—Ä–µ–∑–∞—Ç—å

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  ChatHistoryManager                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  messages   ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ BaseChatHistoryStrategy  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  [user,     ‚îÇ      ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   assistant,‚îÇ      ‚îÇ  ‚îÇ LastNMessages(10)   ‚îÇ ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   user,     ‚îÇ      ‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   ...]      ‚îÇ      ‚îÇ  ‚îÇ TokenBudget(50000)  ‚îÇ ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îÇ   ‚îÇ
‚îÇ                       ‚îÇ  ‚îÇ Unlimited()         ‚îÇ ‚îÇ   ‚îÇ
‚îÇ                       ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ   ‚îÇ
‚îÇ                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢—Ä–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

| –°—Ç—Ä–∞—Ç–µ–≥–∏—è | –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-----------|--------------|-------------------|
| `LastNMessages(10)` | –•—Ä–∞–Ω–∏—Ç 10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö | –ü—Ä–æ—Å—Ç—ã–µ —Å–µ—Å—Å–∏–∏ |
| `TokenBudget(50000)` | –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ | –î–ª–∏–Ω–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ |
| `Unlimited()` | –ù–µ —É–¥–∞–ª—è–µ—Ç –Ω–∏—á–µ–≥–æ | –¢–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤! |

### –ü–∞—Ç—Ç–µ—Ä–Ω Strategy

```
BaseChatHistoryStrategy (ABC)
    ‚îÇ
    ‚îú‚îÄ‚îÄ should_trim(messages) ‚Üí bool
    ‚îÇ       "–ù—É–∂–Ω–æ –ª–∏ –æ–±—Ä–µ–∑–∞—Ç—å?"
    ‚îÇ
    ‚îî‚îÄ‚îÄ trim(messages) ‚Üí list[ChatMessage]
            "–û–±—Ä–µ–∑–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å"
```

–≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω Strategy ‚Äî –º–µ–Ω—è–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞.

---

## üí¨ ChatMessage DTO

–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äî dataclass:

```python
@dataclass
class ChatMessage:
    role: Literal["user", "assistant", "system"]
    content: str
    tokens: int = 0  # –î–ª—è TokenBudget —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
```

–ü–æ—á–µ–º—É –Ω–µ –ø—Ä–æ—Å—Ç–æ `dict`?

- **–¢–∏–ø–∏–∑–∞—Ü–∏—è** ‚Äî IDE –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—è
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî role —Ç–æ–ª—å–∫–æ –∏–∑ —Ç—Ä—ë—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- **–¢–æ–∫–µ–Ω—ã** ‚Äî —Ö—Ä–∞–Ω–∏–º –¥–ª—è —É–º–Ω–æ–≥–æ —Ç—Ä–∏–º–º–∏–Ω–≥–∞

---

## üîÑ –ê–≤—Ç–æ—Ç—Ä–∏–º–º–∏–Ω–≥

–ü—Ä–∏ –∫–∞–∂–¥–æ–º `add()` –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –æ–±—Ä–µ–∑–∞–µ—Ç:

```
add("user", "–Ω–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å")
         ‚îÇ
         ‚ñº
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ messages.append  ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ strategy.should_trim ‚îÇ ‚îÄ‚îÄ‚ñ∂ ‚îÇ len > limit?  ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                       ‚îÇ yes
                                       ‚ñº
                               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                               ‚îÇ strategy.trim ‚îÇ
                               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

–¢—Ä–∏–º–º–∏–Ω–≥ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥—É–º–∞–µ—Ç –æ–± —ç—Ç–æ–º.

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ RAGEngine

RAGEngine —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é:

```python
# –ë–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏ (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
result = rag.ask("–ß—Ç–æ —Ç–∞–∫–æ–µ RRF?")

# –° –∏—Å—Ç–æ—Ä–∏–µ–π
result = rag.ask(
    "–ê –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å FTS?",
    history=manager.get_history()  # [ChatMessage, ChatMessage, ...]
)
```

RAGEngine –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç ChatMessage –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è LLM API:

```python
# –í–Ω—É—Ç—Ä–∏ RAGEngine
history_for_llm = [
    {"role": m.role, "content": m.content}
    for m in history
]
```

---

## ü§ñ Gemini Multi-Turn

–í–∞–∂–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ: Gemini –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–æ–ª—å `"model"`, –Ω–µ `"assistant"`!

```python
# GeminiLLMProvider._build_contents()

for msg in history:
    role = msg["role"]
    # –ú–∞–ø–ø–∏–Ω–≥ –¥–ª—è Gemini API
    gemini_role = "model" if role == "assistant" else "user"
    
    contents.append(
        types.Content(role=gemini_role, parts=[...])
    )
```

–≠—Ç–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–æ –≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ ‚Äî RAGEngine –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞–µ—Ç –æ –º–∞–ø–ø–∏–Ω–≥–µ.

---

## üñ•Ô∏è CLI —Ñ–ª–∞–≥–∏

```bash
# –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî 10 —Å–æ–æ–±—â–µ–Ω–∏–π
semantic chat

# –ë–æ–ª—å—à–µ –∏—Å—Ç–æ—Ä–∏–∏
semantic chat --history-limit 20

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ —Ç–æ–∫–µ–Ω–∞–º
semantic chat --token-budget 100000

# –ë–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏ –≤–æ–æ–±—â–µ
semantic chat --no-history
```

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

1. `--no-history` ‚Üí –æ—Ç–∫–ª—é—á–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é
2. `--token-budget` ‚Üí TokenBudget —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
3. `--history-limit` ‚Üí LastNMessages (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

---

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –≤–∏–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

```
–¢–æ–∫–µ–Ω—ã: 1523 (input: 1200, output: 323) | –∏—Å—Ç–æ—Ä–∏—è: 4 —Å–æ–æ–±—â.
```

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–Ω–∏–º–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞–∫–æ–ø–∏–ª–æ—Å—å.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

40 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Å—Ç–æ–≤ |
|-----------|--------|
| LastNMessages | 8 |
| TokenBudget | 9 |
| Unlimited | 3 |
| ChatHistoryManager | 17 |
| RAGEngine + history | 3 |

–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤:

```python
def test_auto_trim_last_n_messages():
    """–ê–≤—Ç–æ—Ç—Ä–∏–º–º–∏–Ω–≥ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É."""
    manager = ChatHistoryManager(LastNMessages(n=3))
    
    for i in range(5):
        manager.add_user(f"msg{i}")
    
    # –î–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3
    assert len(manager) == 3
    assert manager.get_history()[0].content == "msg2"

def test_trim_removes_old_on_token_overflow():
    """TokenBudget —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è."""
    strategy = TokenBudget(max_tokens=50)
    messages = [
        ChatMessage("user", "old", tokens=30),
        ChatMessage("assistant", "new", tokens=30),
    ]
    
    trimmed = strategy.trim(messages)
    
    # old –Ω–µ –≤–ª–µ–∑–ª–æ ‚Äî –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ new
    assert len(trimmed) == 1
    assert trimmed[0].content == "new"
```

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –¥–∏–∞–ª–æ–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ:

```
You: –ß—Ç–æ —Ç–∞–∫–æ–µ RRF?
Assistant: RRF (Reciprocal Rank Fusion) ‚Äî —ç—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º...

You: –ê –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å FTS?
Assistant: RRF –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã FTS-–ø–æ–∏—Å–∫–∞ —Å –≤–µ–∫—Ç–æ—Ä–Ω—ã–º,
           –ø—Ä–∏—Å–≤–∞–∏–≤–∞—è –∫–∞–∂–¥–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Ä–∞–Ω–≥ –ø–æ —Ñ–æ—Ä–º—É–ª–µ 1/(k+rank)...
```

LLM "–ø–æ–º–Ω–∏—Ç" –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
semantic_core/
‚îú‚îÄ‚îÄ interfaces/
‚îÇ   ‚îî‚îÄ‚îÄ chat_history.py      # ChatMessage, BaseChatHistoryStrategy
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îî‚îÄ‚îÄ context/
‚îÇ       ‚îú‚îÄ‚îÄ strategies.py    # LastNMessages, TokenBudget, Unlimited
‚îÇ       ‚îî‚îÄ‚îÄ manager.py       # ChatHistoryManager
‚îî‚îÄ‚îÄ cli/commands/
    ‚îî‚îÄ‚îÄ chat.py              # --history-limit, --token-budget
```

---

## üîÆ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

Phase 9.2: **Compression** ‚Äî –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π,
–±—É–¥–µ–º –∏—Ö **—Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å** —á–µ—Ä–µ–∑ LLM, —Å–æ—Ö—Ä–∞–Ω—è—è –∫–ª—é—á–µ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

---

**‚Üê [Episode 46: RAG Chat CLI](46_rag_chat_cli.md)** | **[Overview](00_overview.md)**
