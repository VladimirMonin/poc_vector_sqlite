# üìù –°—Ç–∞–π–ª-–≥–∞–π–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Phase 11

> –ö—Ä–∞—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ docs/

---

## üìã Frontmatter (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)

```yaml
---
title: "–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞"
description: "–û–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ —á—ë–º –¥–æ–∫—É–º–µ–Ω—Ç"
tags: [tag1, tag2, tag3]
difficulty: beginner | intermediate | advanced
interfaces: [Interface1, Interface2]  # –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ
related: [file1, file2]               # —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
---
```

---

## üìê –ó–∞–≥–æ–ª–æ–≤–∫–∏

### –ü—Ä–∞–≤–∏–ª–∞
- **H1** ‚Äî —Ç–æ–ª—å–∫–æ title –∏–∑ frontmatter (–Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å)
- **H2** ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ + —ç–º–æ–¥–∑–∏ –≤ –∫–æ–Ω—Ü–µ
- **H3** ‚Äî –ø–æ–¥—Å–µ–∫—Ü–∏–∏ + —ç–º–æ–¥–∑–∏ –≤ –∫–æ–Ω—Ü–µ
- **H4+** ‚Äî –∏–∑–±–µ–≥–∞—Ç—å (—Å–ª–∏—à–∫–æ–º –≥–ª—É–±–æ–∫–æ)

### –ü—Ä–∏–º–µ—Ä
```markdown
## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç üîç

### –®–∞–≥ 1: –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è üìä

### –®–∞–≥ 2: –ü–æ–∏—Å–∫ üéØ
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–µ–∫—Ü–∏–∏

| –°–µ–∫—Ü–∏—è | –≠–º–æ–¥–∑–∏ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|--------|--------|-------------------|
| –ß—Ç–æ —ç—Ç–æ | üìå | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ |
| –ó–∞—á–µ–º –Ω—É–∂–Ω–æ | üéØ | –ú–æ—Ç–∏–≤–∞—Ü–∏—è, –ø—Ä–æ–±–ª–µ–º–∞‚Üí—Ä–µ—à–µ–Ω–∏–µ |
| –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç | üîç | –ú–µ—Ö–∞–Ω–∏–∫–∞, –∞–ª–≥–æ—Ä–∏—Ç–º |
| Prerequisites | üìã | –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º |
| –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è | üõ†Ô∏è | How-to –≥–∞–π–¥—ã |
| –ü–∞—Ä–∞–º–µ—Ç—Ä—ã/–û–ø—Ü–∏–∏ | ‚öôÔ∏è | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| –ü—Ä–∏–º–µ—Ä—ã | üí° | –ö–æ–¥, use cases |
| –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã | ‚ö†Ô∏è | Gotchas, edge cases |
| –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ | ‚ùå | Troubleshooting |
| –°—Ä–∞–≤–Ω–µ–Ω–∏–µ | üìä | –¢–∞–±–ª–∏—Ü–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤ |
| –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã | üîó | –°—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ –¥–æ–∫–∏ |

---

## üìä –¢–∞–±–ª–∏—Ü—ã –≤–º–µ—Å—Ç–æ —Å–ø–∏—Å–∫–æ–≤

### ‚ùå –ü–ª–æ—Ö–æ: –î–ª–∏–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
```markdown
- `chunk_size` ‚Äî —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –≤ —Ç–æ–∫–µ–Ω–∞—Ö
- `overlap` ‚Äî –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –º–µ–∂–¥—É —á–∞–Ω–∫–∞–º–∏
- `min_size` ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
- `max_size` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
```

### ‚úÖ –•–æ—Ä–æ—à–æ: –¢–∞–±–ª–∏—Ü–∞
```markdown
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| chunk_size | int | 1000 | –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –≤ —Ç–æ–∫–µ–Ω–∞—Ö |
| overlap | int | 200 | –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –º–µ–∂–¥—É —á–∞–Ω–∫–∞–º–∏ |
| min_size | int | 100 | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä |
| max_size | int | 2000 | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä |
```

---

## üé® PlantUML –¥–∏–∞–≥—Ä–∞–º–º—ã

### –ü—Ä–∞–≤–∏–ª–∞
1. **–ë–µ–∑ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏** ‚Äî –Ω–∏–∫–∞–∫–∏—Ö skinparam, theme
2. **–ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** ‚Äî `title`
3. **–õ–µ–≥–µ–Ω–¥–∞** ‚Äî `legend` –¥–ª—è –ø–æ—è—Å–Ω–µ–Ω–∏–π
4. **Notes** ‚Äî –¥–ª—è –≤–∞–∂–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

### –¢–∏–ø—ã –¥–∏–∞–≥—Ä–∞–º–º

| –¢–∏–ø | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ |
|-----|-------------------|----------------|
| **Class** | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ | `class`, `interface`, `extends` |
| **Component** | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π | `component`, `package`, `-->` |
| **Sequence** | –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö, API –≤—ã–∑–æ–≤—ã | `->`, `-->`, `activate` |
| **Activity** | –í–µ—Ç–≤–ª–µ–Ω–∏–µ, workflow | `if`, `else`, `fork`, `end fork` |

### –®–∞–±–ª–æ–Ω: Class diagram
```plantuml
@startuml
title –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–æ–∏—Å–∫–∞

interface BaseVectorStore {
    +save_chunks(chunks)
    +search(query, limit)
    +delete_by_source(source_id)
}

class PeeweeVectorStore {
    -db: Database
    +search(query, limit)
}

BaseVectorStore <|.. PeeweeVectorStore

note right of BaseVectorStore
    –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç
    –¥–ª—è –ª—é–±–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
end note

legend right
    |= –°–∏–º–≤–æ–ª |= –ó–Ω–∞—á–µ–Ω–∏–µ |
    | <|.. | –†–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
    | --> | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç |
endlegend
@enduml
```

### –®–∞–±–ª–æ–Ω: Sequence diagram
```plantuml
@startuml
title –ü–æ—Ç–æ–∫ –ø–æ–∏—Å–∫–∞

actor User
participant CLI
participant SemanticCore
participant Embedder
participant VectorStore

User -> CLI: search "query"
CLI -> SemanticCore: search(query)
SemanticCore -> Embedder: embed_query(query)
Embedder --> SemanticCore: vector[768]
SemanticCore -> VectorStore: search(vector, limit=10)
VectorStore --> SemanticCore: results[]
SemanticCore --> CLI: SearchResult[]
CLI --> User: formatted output

note over Embedder
    Gemini API
    text-embedding-004
end note

legend right
    –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫
    Vector + FTS5 + RRF
endlegend
@enduml
```

### –®–∞–±–ª–æ–Ω: Activity diagram
```plantuml
@startuml
title –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –ø–æ–∏—Å–∫–∞

start

:–ü–æ–ª—É—á–∏—Ç—å –∑–∞–ø—Ä–æ—Å;

if (mode == "vector") then (yes)
    :–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫;
elseif (mode == "fts") then (yes)
    :FTS5 –ø–æ–∏—Å–∫;
else (hybrid)
    fork
        :–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫;
    fork again
        :FTS5 –ø–æ–∏—Å–∫;
    end fork
    :RRF —Å–ª–∏—è–Ω–∏–µ;
endif

:–í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã;

stop

legend right
    RRF = Reciprocal Rank Fusion
    k = 60 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
endlegend
@enduml
```

### –®–∞–±–ª–æ–Ω: Component diagram
```plantuml
@startuml
title –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Semantic Core

package "Domain" {
    [Document]
    [Chunk]
    [SearchResult]
}

package "Interfaces" {
    [BaseEmbedder]
    [BaseVectorStore]
    [BaseLLMProvider]
}

package "Infrastructure" {
    [GeminiEmbedder]
    [PeeweeVectorStore]
    [GeminiLLMProvider]
}

package "Core" {
    [SemanticCore]
    [RAGEngine]
}

[SemanticCore] --> [BaseEmbedder]
[SemanticCore] --> [BaseVectorStore]
[RAGEngine] --> [BaseLLMProvider]
[RAGEngine] --> [SemanticCore]

[GeminiEmbedder] ..|> [BaseEmbedder]
[PeeweeVectorStore] ..|> [BaseVectorStore]
[GeminiLLMProvider] ..|> [BaseLLMProvider]

note bottom of Infrastructure
    –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
    –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω—è—Ç—å
end note

legend right
    |= –°—Ç—Ä–µ–ª–∫–∞ |= –ó–Ω–∞—á–µ–Ω–∏–µ |
    | --> | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç |
    | ..|> | –†–µ–∞–ª–∏–∑—É–µ—Ç |
endlegend
@enduml
```

---

## üìè –†–∞–∑–º–µ—Ä—ã

| –ú–µ—Ç—Ä–∏–∫–∞ | –õ–∏–º–∏—Ç |
|---------|-------|
| –°—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–µ | ‚â§ 400 |
| –ë–ª–æ–∫–æ–≤ –∫–æ–¥–∞ | ‚â§ 3 –Ω–∞ —Ñ–∞–π–ª |
| –°—Ç—Ä–æ–∫ –≤ –±–ª–æ–∫–µ –∫–æ–¥–∞ | ‚â§ 15 |
| –í–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –ø–∞–ø–æ–∫ | ‚â§ 2 —É—Ä–æ–≤–Ω—è |

---

## üîó –°—Å—ã–ª–∫–∏

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ
```markdown
[–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫](../concepts/03_hybrid_rrf.md)
[CLI –∫–æ–º–∞–Ω–¥—ã](../reference/cli-commands.md#search)
```

### –°–µ–∫—Ü–∏—è –≤ –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞
```markdown
---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã üîó

- [–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫](02_vector_search.md) ‚Äî –æ—Å–Ω–æ–≤–∞ hybrid search
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ RRF](../reference/configuration-options.md#search) ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä rrf_k
- [CLI –ø–æ–∏—Å–∫](../guides/cli-usage.md#search) ‚Äî –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

- [ ] Frontmatter –∑–∞–ø–æ–ª–Ω–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
- [ ] –ó–∞–≥–æ–ª–æ–≤–∫–∏ H2/H3 —Å —ç–º–æ–¥–∑–∏
- [ ] –¢–∞–±–ª–∏—Ü—ã –≤–º–µ—Å—Ç–æ –¥–ª–∏–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤
- [ ] PlantUML –±–µ–∑ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏, —Å title –∏ legend
- [ ] ‚â§ 400 —Å—Ç—Ä–æ–∫
- [ ] ‚â§ 3 –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞
- [ ] –°–µ–∫—Ü–∏—è "–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã" –≤ –∫–æ–Ω—Ü–µ
- [ ] –í—Å–µ —Å—Å—ã–ª–∫–∏ –≤–∞–ª–∏–¥–Ω—ã
