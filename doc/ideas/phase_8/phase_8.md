[Image of CLI architecture diagram]

–≠—Ç–æ –æ—á–µ–Ω—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥. –î–∞–≤–∞–π —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ–º **–§–∞–∑—É 8 (CLI)** –Ω–µ –∫–∞–∫ "–ø—Ä–∏–¥–∞—Ç–æ–∫", –∞ –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π **Control Plane** (–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è) —Ç–≤–æ–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

–ò–¥–µ—è —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ `Rich` ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è. –≠—Ç–æ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç CLI –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —É—á–µ–±–Ω–∏–∫.

–í–æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –≤–∏–¥–µ–Ω–∏–µ —Ç–æ–≥–æ, –∫–∞–∫ —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É—Å—Ç—Ä–æ–µ–Ω–æ, —á—Ç–æ–±—ã –±—ã–ª–æ **—É–¥–æ–±–Ω–æ, –≥–∏–±–∫–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ**.

-----

### üß† –§–∏–ª–æ—Å–æ—Ñ–∏—è CLI: "Human Friendly, Machine Readable"

CLI –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–≤–∞ –ª–∏—Ü–∞:

1. **–î–ª—è —á–µ–ª–æ–≤–µ–∫–∞:** –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥, —Å–ø–∏–Ω–Ω–µ—Ä—ã, —Ç–∞–±–ª–∏—Ü—ã, Markdown-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (—á–µ—Ä–µ–∑ `Rich`).
2. **–î–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤/–∞–≥–µ–Ω—Ç–æ–≤:** –§–ª–∞–≥ `--json`, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫–ª—é—á–∞–µ—Ç –≤—Å—é –∫—Ä–∞—Å–æ—Ç—É –∏ –≤—ã–¥–∞–µ—Ç —á–∏—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–∞–π–ø–∏–Ω–≥–∞ (`| jq`).

-----

### üì¶ –ì—Ä—É–ø–ø—ã –ö–æ–º–∞–Ω–¥ (Command Groups)

–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞–∑–±–∏—Ç—å CLI –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–µ–º `Typer` ‚Äî –æ–Ω –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ (subcommands).

#### 1\. –ì—Ä—É–ø–ø–∞ `ingest` (–ü–∏—Ç–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã)

–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ —Ç–æ, —á—Ç–æ —Ç—ã –±—É–¥–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∞—â–µ –≤—Å–µ–≥–æ.

* `semantic ingest <path>`
  * **–ê—Ä–≥—É–º–µ–Ω—Ç:** –§–∞–π–ª –∏–ª–∏ –ø–∞–ø–∫–∞. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ ‚Äî —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ.
  * **–§–ª–∞–≥–∏:**
    * `--mode [sync|async]`: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º.
    * `--media / --no-media`: –í–∫–ª—é—á–∞—Ç—å –ª–∏ –∞–Ω–∞–ª–∏–∑ –∫–∞—Ä—Ç–∏–Ω–æ–∫/–∞—É–¥–∏–æ (—ç–∫–æ–Ω–æ–º–∏—è –¥–µ–Ω–µ–≥).
    * `--watch`: (–ö–∏–ª–ª–µ—Ä-—Ñ–∏—á–∞) –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è. –ï—Å–ª–∏ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Äî –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ.
  * **UX:** –ö—Ä–∞—Å–∏–≤—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä: `[‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë] Processing image.jpg...`

#### 2\. –ì—Ä—É–ø–ø–∞ `search` (–ü–æ–∏—Å–∫ –∏ –ß–∞—Ç)

–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

* `semantic search "query"`

  * **–§–ª–∞–≥–∏:**
    * `--limit 5`
    * `--type [all|text|code|image|audio]`
    * `--raw`: –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç —á–∞–Ω–∫–∞ (–±–µ–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö).
  * **UX:** –í—ã–≤–æ–¥ –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã `Rich Table` (Score | Type | Source | Preview).

* `semantic chat` (REPL —Ä–µ–∂–∏–º)

  * –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é.
  * –í–Ω—É—Ç—Ä–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç RAG: –ü–æ–∏—Å–∫ -\> –ö–æ–Ω—Ç–µ–∫—Å—Ç -\> LLM -\> –û—Ç–≤–µ—Ç.
  * **–§–∏—à–∫–∞:** –†–µ–Ω–¥–µ—Ä–∏—Ç –æ—Ç–≤–µ—Ç Gemini –∫–∞–∫ Markdown –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (—Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –∫–æ–¥–∞).

#### 3\. –ì—Ä—É–ø–ø–∞ `queue` (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é)

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫ —Ç–≤–æ–µ–º—É `BatchManager` –∏ —Ç–∞–±–ª–∏—Ü–∞–º `BatchJob`.

* `semantic queue status`
  * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞—à–±–æ—Ä–¥: "Pending: 150, Processing: 5, Failed: 2".
* `semantic queue flush`
  * –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–µ –≤ Google Batch (–∏–≥–Ω–æ—Ä–∏—Ä—É—è `min_size`).
* `semantic queue retry`
  * –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —É–ø–∞–≤—à–∏–µ –∑–∞–¥–∞—á–∏ (`FAILED`).

#### 4\. –ì—Ä—É–ø–ø–∞ `worker` (–§–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã)

–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–µ–º–æ–Ω–æ–≤.

* `semantic worker start`
  * –ó–∞–ø—É—Å–∫–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏ (Media Local Queue + Text Batch Sync).
  * –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è `systemd` –∏–ª–∏ `docker entrypoint`.
* `semantic worker run-once`
  * –ü—Ä–æ–≥–æ–Ω—è–µ—Ç –æ—á–µ—Ä–µ–¥—å –æ–¥–∏–Ω —Ä–∞–∑ –∏ –≤—ã—Ö–æ–¥–∏—Ç (–¥–ª—è `cron`).

#### 5\. –ì—Ä—É–ø–ø–∞ `docs` (–¢–≤–æ—è –∏–¥–µ—è\!)

–î–æ—Å—Ç—É–ø –∫ –∑–Ω–∞–Ω–∏—è–º –æ —Å–∞–º–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ.

* `semantic docs <topic>`
  * `semantic docs architecture` -\> –†–µ–Ω–¥–µ—Ä–∏—Ç `00_overview.md`.
  * `semantic docs install` -\> –†–µ–Ω–¥–µ—Ä–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ.
  * **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ú—ã –≤–∫–ª—é—á–∞–µ–º MD —Ñ–∞–π–ª—ã –≤ –ø–∞–∫–µ—Ç –ø—Ä–∏ —Å–±–æ—Ä–∫–µ (`MANIFEST.in`). –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ—Å—Ç–æ —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª –∏ —Å–∫–∞—Ä–º–ª–∏–≤–∞–µ—Ç –µ–≥–æ `rich.markdown.Markdown`.
  * **–ü–ª—é—Å:** –ù–µ –Ω—É–∂–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ö–µ–ª–ø –≤ –∫–æ–¥–µ. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∂–∏–≤–µ—Ç –≤ MD —Ñ–∞–π–ª–∞—Ö.

-----

### üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –î–µ—Ç–∞–ª–∏ (Implementation Details)

#### 1\. –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏ (Global Options)

–î–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥—ã:

* `--db-path`: –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—É—Ç—å –∫ SQLite.
* `--log-level [INFO|DEBUG|TRACE]`: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—à–∏–º `SemanticLogger`.
* `--json`: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –≤ JSON (–≥–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ).

#### 2\. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏ (Django/Flask)

–¢—ã —Å–ø—Ä–æ—Å–∏–ª –ø—Ä–æ —É–¥–æ–±—Å—Ç–≤–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è.

**–°—Ü–µ–Ω–∞—Ä–∏–π Django:**
–í —Å–≤–æ–µ–º `manage.py` –∏–ª–∏ –≤ –∞–¥–º–∏–Ω–∫–µ —Ç—ã –º–æ–∂–µ—à—å –≤—ã–∑—ã–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã CLI –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ, –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CLI –∫–∞–∫ –≤–Ω–µ—à–Ω–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —É–∫–∞–∑—ã–≤–∞—è –ø—É—Ç—å –∫ —Ç–æ–π –∂–µ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```bash
# –í –ø–∞–ø–∫–µ –¥–∂–∞–Ω–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
semantic search "—é–∑–µ—Ä—ã" --db-path ./db.sqlite3
```

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –Ω–∞—É—á–∏—Ç—å `semantic_core` –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –±–∞–∑–µ, –µ—Å–ª–∏ –æ–Ω–∞ –∑–∞–Ω—è—Ç–∞ –î–∂–∞–Ω–≥–æ–π (WAL —Ä–µ–∂–∏–º SQLite —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç).

#### 3\. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`semantic init`)

–ö–æ–º–∞–Ω–¥–∞ `init` —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `semantic.toml` (–∏–ª–∏ `.env`) –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ.
CLI –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª, —á—Ç–æ–±—ã –Ω–µ –≤–≤–æ–¥–∏—Ç—å –∫–ª—é—á–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑.

-----

### –ò—Ç–æ–≥–æ–≤–æ–µ –≤–∏–¥–µ–Ω–∏–µ –º–µ–Ω—é (`--help`)

```text
Usage: semantic [OPTIONS] COMMAND [ARGS]...

  üß† Semantic Core CLI ‚Äî –í–∞—à –≤—Ç–æ—Ä–æ–π –º–æ–∑–≥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

Options:
  --db-path PATH  –ü—É—Ç—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
  --json          –í—ã–≤–æ–¥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.
  --verbose       –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏.
  --help          Show this message and exit.

Commands:
  ingest   üì• –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤/–ø–∞–ø–æ–∫.
  search   üîç –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ.
  chat     üí¨ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç —Å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π.
  queue    üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é –∑–∞–¥–∞—á (Batch API).
  worker   üë∑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤—ã–º –≤–æ—Ä–∫–µ—Ä–æ–º.
  docs     üìö –ß–∏—Ç–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (Architecture, API).
  init     ‚öôÔ∏è –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ.
```

[Image of CLI architecture diagram]

–≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å. –î–∞–≤–∞–π —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É CLI —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ –±—ã–ª–∞ **–º–æ–¥—É–ª—å–Ω–æ–π** (–∫–∞–∫ Lego), –∞ –Ω–µ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–π (–∫–∞–∫ —Å–ø–∞–≥–µ—Ç—Ç–∏).

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω **"Command as a Service"**. –ö–∞–∂–¥–∞—è –≥—Ä—É–ø–ø–∞ –∫–æ–º–∞–Ω–¥ ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –≥–ª–∞–≤–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é.

–í–æ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è **–§–∞–∑—ã 8**.

-----

# üó∫Ô∏è Phase 8: Semantic CLI & Chat Interface

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (`semantic`) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —è–¥—Ä–æ–º, –æ—Ç–ª–∞–¥–∫–∏ –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã.
**–ü—Ä–∏–Ω—Ü–∏–ø:** CLI ‚Äî —ç—Ç–æ "—Ç–æ–Ω–∫–∏–π –∫–ª–∏–µ–Ω—Ç". –í—Å—è –ª–æ–≥–∏–∫–∞ –≤ —è–¥—Ä–µ, CLI –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–≤–æ–¥–æ–º/–≤—ã–≤–æ–¥–æ–º (IO) –∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö.

-----

### üì¶ 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü–∞–∫–µ—Ç–∞ (`semantic_core/cli`)

–ú—ã —Ä–∞–∑–¥–µ–ª—è–µ–º "–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥" –∏ "–ª–æ–≥–∏–∫—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è".

```text
semantic_core/
‚îú‚îÄ‚îÄ cli/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (def main)
‚îÇ   ‚îú‚îÄ‚îÄ app.py               # Typer –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–ª–±—ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ context.py           # Dependency Injection –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (ctx.obj)
‚îÇ   ‚îú‚îÄ‚îÄ commands/            # –ú–û–î–£–õ–ò –ö–û–ú–ê–ù–î (Sub-apps)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ingest.py        # –ö–æ–º–∞–Ω–¥—ã –∑–∞–≥—Ä—É–∑–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search.py        # –ö–æ–º–∞–Ω–¥—ã –ø–æ–∏—Å–∫–∞ –∏ —á–∞—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ queue.py         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞—Ç—á–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ worker.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–º–æ–Ω–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py        # init, check-env
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ docs.py          # –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ ui/                  # –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–ï (View Layer)
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ console.py       # –ì–ª–æ–±–∞–ª—å–Ω—ã–π Rich Console
‚îÇ       ‚îú‚îÄ‚îÄ renderers.py     # –§—É–Ω–∫—Ü–∏–∏: render_results_table, render_markdown
‚îÇ       ‚îî‚îÄ‚îÄ spinners.py      # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
```

-----

### üß† 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°–æ—Å—Ç–æ—è–Ω–∏–µ–º (`context.py`)

Typer –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (`ctx`) –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏. –ú—ã —Å–æ–∑–¥–∞–¥–∏–º —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è.

```python
@dataclass
class CLIContext:
    config: GeminiConfig
    core: SemanticCore
    console: Console
    verbose: bool = False
    
    # –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–¥—Ä–∞ (—á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥–∞ --help —Ä–∞–±–æ—Ç–∞–ª–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
    def get_core(self) -> SemanticCore:
        if not self._core_initialized:
            # ... init logic ...
        return self.core
```

**–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ï—Å–ª–∏ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏–ª–∏ –ø–ª–∞–≥–∏–Ω, –º—ã –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏–º –ø–æ–ª–µ –≤ `CLIContext`, –∏ –æ–Ω–æ —Å—Ç–∞–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –≤–æ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥–∞—Ö.

-----

### ‚öôÔ∏è 3. –î–∏–∑–∞–π–Ω –ö–æ–º–∞–Ω–¥ (Command Modules)

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª –≤ `commands/` —Å–æ–∑–¥–∞–µ—Ç —Å–≤–æ–π `typer.Typer()` –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ç–æ–º –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

#### A. `ingest.py` (Loader)

* **–õ–æ–≥–∏–∫–∞:**
  * –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `Path`.
  * –ï—Å–ª–∏ —Ñ–∞–π–ª -\> `core.ingest(file)`.
  * –ï—Å–ª–∏ –ø–∞–ø–∫–∞ -\> `glob` (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ) -\> —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º -\> —Ü–∏–∫–ª `ingest`.
  * **Rich Integration:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `Progress` (–ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä) –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–ø–∫–∏.

#### B. `search.py` (Retrieval)

* **Command `query`:**
  * –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–∏—Å–∫.
  * –ü–µ—Ä–µ–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `ui.renderers.print_search_results(results)`.
* **Command `chat`:**
  * –ó–∞–ø—É—Å–∫–∞–µ—Ç `while True` —Ü–∏–∫–ª.
  * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `rich.prompt.Prompt` –¥–ª—è –≤–≤–æ–¥–∞.
  * –†–µ–Ω–¥–µ—Ä–∏—Ç –æ—Ç–≤–µ—Ç –ø–æ—Ç–æ–∫–æ–≤–æ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è) –∏–ª–∏ –±–ª–æ–∫–æ–º Markdown.
  * **–§–∏—à–∫–∞:** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç `/source 1`, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ ‚Ññ1 (drill-down).

#### C. `worker.py` (Daemons)

* –ü—Ä–æ—Å—Ç–æ –æ–±–µ—Ä—Ç–∫–∏ –Ω–∞–¥ `batch_manager`.
* `start`: –í–µ—á–Ω—ã–π —Ü–∏–∫–ª `while True`. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç `Ctrl+C` –¥–ª—è graceful shutdown.

#### D. `docs.py` (Knowledge Base)

* –ß–∏—Ç–∞–µ—Ç MD —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ `doc/` (–∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É–ø–∞–∫–æ–≤–∞–Ω–∞ –≤ wheel).
* –í—ã–≤–æ–¥–∏—Ç –∏—Ö —á–µ—Ä–µ–∑ `Console(markdown=...)`.
* –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–∏—Ç–∞—Ç—å –ø—Ä–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –Ω–µ –≤—ã—Ö–æ–¥—è –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞: `semantic docs architecture`.

-----

### üé® 4. –°–ª–æ–π –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (`ui/`)

–ú—ã –≤—ã–Ω–æ—Å–∏–º –≤—Å—é –∫—Ä–∞—Å–æ—Ç—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–æ **YAGNI** (–Ω–µ –ø–∏—à–µ–º —Å–ª–æ–∂–Ω—ã–π TUI), –Ω–æ **SOLID** (–æ—Ç–¥–µ–ª—è–µ–º –ª–æ–≥–∏–∫—É –æ—Ç –≤–∏–¥–∞).

* **`renderers.py`**:
  * `render_chunk_table(chunks)`: –†–∏—Å—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ ID, Type, Preview.
  * `render_error(exc)`: –ö—Ä–∞—Å–∏–≤–∞—è –∫—Ä–∞—Å–Ω–∞—è –ø–∞–Ω–µ–ª—å —Å –æ—à–∏–±–∫–æ–π.
  * `render_success(msg)`: –ó–µ–ª–µ–Ω–∞—è –≥–∞–ª–æ—á–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º.

-----

### üõ°Ô∏è 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –õ–æ–≥–≥–µ—Ä–æ–º (–§–∞–∑–∞ 7)

–í `app.py` (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞) –º—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º `setup_logging`.

* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –£—Ä–æ–≤–µ–Ω—å `WARNING` (—á—Ç–æ–±—ã –Ω–µ –º—É—Å–æ—Ä–∏—Ç—å –≤ –≤—ã–≤–æ–¥ CLI –∫–æ–º–∞–Ω–¥).
* –§–ª–∞–≥ `--verbose`: –£—Ä–æ–≤–µ–Ω—å `INFO` (–≤–∏–¥–Ω–æ —ç–º–æ–¥–∑–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞).
* –§–ª–∞–≥ `--debug`: –£—Ä–æ–≤–µ–Ω—å `DEBUG` + –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–µ —Ç—Ä–µ–π—Å–±–µ–∫–∏ –æ—à–∏–±–æ–∫.

-----

### ‚úÖ –ò—Ç–æ–≥ –ø–ª–∞–Ω–∞

–ú—ã —Å—Ç—Ä–æ–∏–º CLI –∫–∞–∫ **–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä**:

1. `main.py` —Å–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
2. `commands/*.py` —Ä–µ–∞–ª–∏–∑—É—é—Ç –¥–µ–π—Å—Ç–≤–∏—è.
3. `ui/*.py` –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –∫—Ä–∞—Å–æ—Ç—É.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Ç–µ–±–µ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `semantic plugins install ...` –∏–ª–∏ `semantic stats` –≤ –±—É–¥—É—â–µ–º, –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –≤ `commands/`.
