# 📋 Phase 9: RAG Chat Interface

**Статус:** 🔲 Планируется  
**Зависимости:** Phase 8 (CLI) ✅  
**Общая оценка:** ~3-4 дня

---

## 🎯 Цель

Создать интерактивный чат-интерфейс с RAG (Retrieval-Augmented Generation):

- **REPL режим** — бесконечный цикл вопрос-ответ
- **Контекстный поиск** — автоматический retrieval из базы
- **LLM генерация** — ответы через LLM с контекстом
- **Гибкость провайдеров** — не только Gemini
- **Управление историей** — стратегии ограничения контекста

---

## 📦 Подфазы

| Фаза | Название | Описание | Оценка |
|------|----------|----------|--------|
| [9.0](phase_9.0.md) | Core RAG | BaseLLMProvider + RAGEngine + базовый chat | 1.5 дня |
| [9.1](phase_9.1.md) | Context Management | Стратегии управления историей (N сообщений / токены) | 0.5 дня |
| [9.2](phase_9.2.md) | Compression | Автосжатие контекста через summarization | 0.5 дня |
| [9.3](phase_9.3.md) | Slash Commands | /search, /add, /media, /tokens и др. | 1 день |

---

## 🏗️ Общая архитектура

```
┌─────────────────────────────────────────────────────────────────────┐
│                         semantic chat                               │
├─────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                      ChatSession                            │    │
│  │  ┌───────────────┐  ┌──────────────┐  ┌─────────────────┐   │    │
│  │  │ ContextManager│  │ RAGEngine    │  │ SlashHandler    │   │    │
│  │  │ (9.1 + 9.2)   │  │ (9.0)        │  │ (9.3)           │   │    │
│  │  └───────────────┘  └──────────────┘  └─────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                │                                     │
│                                ▼                                     │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                    BaseLLMProvider                          │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │    │
│  │  │ Gemini ✅   │  │ OpenAI ❌   │  │ Ollama ❌   │          │    │
│  │  │ (9.0)       │  │ (future)    │  │ (future)    │          │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘          │    │
│  └─────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 📊 SOLID/KISS/YAGNI

| Принцип | Реализация |
|---------|------------|
| **S** | RAGEngine, ContextManager, SlashHandler — отдельные классы |
| **O** | BaseLLMProvider + BaseContextStrategy — расширяемо |
| **L** | Любой провайдер/стратегия взаимозаменяемы |
| **I** | Минимальные интерфейсы |
| **D** | Зависим от абстракций |
| **KISS** | Каждая подфаза — изолированная функциональность |
| **YAGNI** | OpenAI/Ollama/streaming — только когда понадобится |

---

## 🔗 Связи

- **Использует:** Phase 8 (CLI), Phase 6 (RateLimiter), Phase 1-5 (search)
- **Документация:** Episode 44-47 (по подфазам)
- **Переименовано из:** Phase 8.2

---

**Создано:** 3 декабря 2025
