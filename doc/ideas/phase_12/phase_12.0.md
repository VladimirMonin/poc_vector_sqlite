Ð­Ñ‚Ð¾ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð¿Ð»Ð°Ð½. ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ Ðº Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ (Phase 12) â€” ÑÑ‚Ð¾ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚ Ð¸ÑÑ‚Ð¸Ð½Ñ‹ Ð´Ð»Ñ Ð²ÑÐµÐ¹ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñ‹.

ÐœÑ‹ ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ **"Semantic Knowledge Base MVP"**. Ð­Ñ‚Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚ (Ð² Ð¿Ð°Ð¿ÐºÐµ `examples/flask_app`), ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð»ÑÐµÑ‚ Ñ‚Ð²Ð¾ÑŽ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÑƒ `semantic_core`.

Ð’Ð¾Ñ‚ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð»Ð°Ð½, Ñ€Ð°Ð·Ð±Ð¸Ñ‚Ñ‹Ð¹ Ð½Ð° Ð¿Ð¾Ð´Ñ„Ð°Ð·Ñ‹, Ñ ÑƒÐ¿Ð¾Ñ€Ð¾Ð¼ Ð½Ð° **HTMX**, **Logging** Ð¸ **TDD**.

---

# ðŸ—ºï¸ Phase 12: Semantic Flask App (Knowledge Base MVP)

**Ð¦ÐµÐ»ÑŒ:** Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ðµ Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð±Ð°Ð·Ð¾Ð¹ Ð·Ð½Ð°Ð½Ð¸Ð¹, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‰ÐµÐµ Ð²ÑÐµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ `semantic_core` (Ð¿Ð¾Ð¸ÑÐº, RAG, Ð¼ÐµÐ´Ð¸Ð°).
**Ð¡Ñ‚ÐµÐº:** Flask, Peewee, Jinja2, HTMX (Ð¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ), Bootstrap 5 + Bootstrap Icons (UI), Highlight.js (ÐºÐ¾Ð´).

---

## ðŸ“ Ð£Ñ‚Ð²ÐµÑ€Ð¶Ð´Ñ‘Ð½Ð½Ñ‹Ðµ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ

| Ð’Ð¾Ð¿Ñ€Ð¾Ñ | Ð ÐµÑˆÐµÐ½Ð¸Ðµ |
|--------|---------|
| **Ð Ð°ÑÐ¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ** | `examples/flask_app/` â€” Ð´ÐµÐ¼Ð¾-Ð¿Ñ€Ð¾ÐµÐºÑ‚, Ð½Ðµ Ð·Ð°ÑÐ¾Ñ€ÑÐµÑ‚ ÐºÐ¾Ñ€ÐµÐ½ÑŒ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ |
| **DI Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½** | Flask-native: `app.extensions['semantic_core']` (ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚ Flask-Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ð¹) |
| **Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…** | ÐžÐ±Ñ‰Ð°Ñ Ñ CLI (`semantic.db` Ð¸Ð»Ð¸ Ð¿ÑƒÑ‚ÑŒ Ð¸Ð· `semantic.toml`) â€” CLI Ð½Ð°Ð¿Ð¾Ð»Ð½ÑÐµÑ‚, Flask Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ |
| **ÐšÑÑˆ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²** | Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Flask app (Ð½Ðµ Ð² ÑÐ´Ñ€Ðµ), Ð±ÐµÐ· LRU/TTL Ð´Ð»Ñ MVP |
| **Markdown Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³** | `markdown-it-py` (ÑƒÐ¶Ðµ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÑÑ…) |
| **Score Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ** | `f"{score:.4f}"`: >0.02 Ð·ÐµÐ»Ñ‘Ð½Ñ‹Ð¹, <0.01 ÑÐµÑ€Ñ‹Ð¹ (Ð±ÐµÐ· Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸) |
| **Uploads** | ÐŸÐ¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ `uploads/` Ñ UUID-Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ |
| **Sync/Async** | ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸: <5 Ñ„Ð°Ð¹Ð»Ð¾Ð² â†’ Sync, â‰¥5 â†’ Async |
| **Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ñ‡Ð°Ñ‚Ð°** | SQLite Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° `chat_sessions` (Ð² Ñ‚Ð¾Ð¹ Ð¶Ðµ Ð‘Ð”) |
| **Streaming** | ÐÐµÑ‚ (ÑÐ¿Ð¸Ð½Ð½ÐµÑ€ "ÐŸÐµÑ‡Ð°Ñ‚Ð°ÐµÑ‚..." + Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚) |
| **Worker** | Ð¢Ñ€ÐµÐ´ Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾, `systemd` Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð° |
| **Ð¢ÐµÑÑ‚Ñ‹** | `pytest-flask` |
| **Ð¢ÐµÐ¼Ð°** | Bootstrap 5.3 Ñ Ð°Ð²Ñ‚Ð¾ Dark Mode (`prefers-color-scheme`) |

---

### ðŸ“¦ 12.0: Setup & Infrastructure (Ð¤ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚)

**Ð¦ÐµÐ»ÑŒ:** Ð Ð°Ð·Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°, Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ DI (Dependency Injection) ÑÐ´Ñ€Ð°, Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð»Ð¾Ð³Ð³ÐµÑ€ Ð¸ Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹.

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ:**

- Ð Ð°ÑÐ¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ: `examples/flask_app/`
- DI: Flask-native Ñ‡ÐµÑ€ÐµÐ· `app.extensions['semantic_core']`
- Ð‘Ð”: ÐžÐ±Ñ‰Ð°Ñ Ñ CLI (Ð¿ÑƒÑ‚ÑŒ Ð¸Ð· `SemanticConfig`)

**Ð—Ð°Ð´Ð°Ñ‡Ð¸:**

1. **Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°:**
    - Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ `examples/flask_app/` Ñ Ð¿Ð°Ð¿ÐºÐ°Ð¼Ð¸ `app/routes`, `app/templates`, `app/static`.
    - ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ `create_app()` Ñ„Ð°Ð±Ñ€Ð¸ÐºÑƒ.
2. **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ð¯Ð´Ñ€Ð°:**
    - `SemanticCore` Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð² `create_app()` Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð² `app.extensions['semantic_core']`.
    - Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð° Ñ‡ÐµÑ€ÐµÐ· `SemanticConfig` (Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚: env â†’ `semantic.toml`).
3. **Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (Observability):**
    - ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ `SemanticLogger` Ðº Flask Ñ‡ÐµÑ€ÐµÐ· `setup_logging()`.
    - ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ middleware Ð´Ð»Ñ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ HTTP: `ðŸŒ [GET] /search`.
    - Ð­Ð¼Ð¾Ð´Ð·Ð¸-Ð¼Ð°Ð¿Ð¿Ð¸Ð½Ð³ Ð´Ð»Ñ Ð²ÐµÐ±-ÑÐ»Ð¾Ñ (`ðŸŒ`, `ðŸ”¥`, `âš¡`).
4. **Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ UI (Base Templates):**
    - `base.html` Ñ Bootstrap 5.3 (CDN) + Bootstrap Icons.
    - ÐÐ²Ñ‚Ð¾ Dark Mode Ñ‡ÐµÑ€ÐµÐ· `data-bs-theme` + `prefers-color-scheme`.
    - ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ HTMX.js.
    - ÐœÐ°ÐºÐµÑ‚: ÐÐ°Ð²Ð±Ð°Ñ€, Ð¡Ð°Ð¹Ð´Ð±Ð°Ñ€, ÐšÐ¾Ð½Ñ‚ÐµÐ½Ñ‚.

**Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (12.0):**

- `test_app_factory.py`: ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ, ÐºÐ¾Ð½Ñ„Ð¸Ð³ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ.
- `test_core_injection.py`: Ð¯Ð´Ñ€Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ Ñ‡ÐµÑ€ÐµÐ· `current_app.extensions['semantic_core']`.
- `test_logging.py`: HTTP Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¸ÑˆÑƒÑ‚ÑÑ Ð² Ð»Ð¾Ð³ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ ÑÐ¼Ð¾Ð´Ð·Ð¸.

---

### ðŸ“¦ 12.1: Search Query Cache (ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ)

**Ð¦ÐµÐ»ÑŒ:** Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ¼Ð±ÐµÐ´Ð´Ð¸Ð½Ð³Ð¾Ð² Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾ÐºÐ¾Ð¼Ð¿Ð»Ð¸Ñ‚Ð° Ð¸ ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ð¸ Ð´ÐµÐ½ÐµÐ³.

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ:**

- Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `SearchQuery` â€” **Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð°Ñ Ð´Ð»Ñ Flask app** (Ð½Ðµ Ð² ÑÐ´Ñ€Ðµ)
- Ð‘ÐµÐ· LRU/TTL eviction Ð´Ð»Ñ MVP

**Ð—Ð°Ð´Ð°Ñ‡Ð¸:**

1. **ÐœÐ¾Ð´ÐµÐ»ÑŒ ÐšÑÑˆÐ° (`models/cache.py`):**
    - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `SearchQuery`: `query_hash` (index), `query_text`, `embedding_blob`, `frequency`, `last_used`.
2. **Ð¡ÐµÑ€Ð²Ð¸Ñ ÐšÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ (`services/cache_service.py`):**
    - ÐœÐµÑ‚Ð¾Ð´ `get_or_embed(query)`:
        - Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð² ÐºÑÑˆÐµ -> Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð²ÐµÐºÑ‚Ð¾Ñ€ + Ð¸Ð½ÐºÑ€ÐµÐ¼ÐµÐ½Ñ‚ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ñ‹.
        - Ð•ÑÐ»Ð¸ Ð½ÐµÑ‚ -> `core.embedder.embed_query()` -> ÑÐ¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ -> Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ.
    - ÐœÐµÑ‚Ð¾Ð´ `suggest(partial_query)`: ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ `query_text` (LIKE %) Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð°Ð´Ð°ÑŽÑ‰ÐµÐ³Ð¾ ÑÐ¿Ð¸ÑÐºÐ°.
3. **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ:** Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¿Ñ€ÑÐ¼Ð¾Ð¹ Ð²Ñ‹Ð·Ð¾Ð² ÑÐ¼Ð±ÐµÐ´Ð´ÐµÑ€Ð° Ð² Ð¿Ð¾Ð¸ÑÐºÐµ Ð½Ð° Ð²Ñ‹Ð·Ð¾Ð² ÑÐµÑ€Ð²Ð¸ÑÐ°.

**Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (12.1):**

- `test_cache_hit_miss.py`: ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ API, Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ â€” Ð½ÐµÑ‚.
- `test_suggestion.py`: Ð§Ð°ÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð²Ð²Ð¾Ð´ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¿Ð¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹.

---

### ðŸ“¦ 12.2: Intelligent Search Interface (ÐŸÐ¾Ð¸ÑÐº Ð¸ ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€)

**Ð¦ÐµÐ»ÑŒ:** Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼Ð¾Ñ‰Ð½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð¿Ð¾Ð¸ÑÐºÐ° Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ð¼Ð¸ Ð¸ Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³Ð¾Ð¼ Markdown.

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ:**

- Markdown â†’ HTML Ñ‡ÐµÑ€ÐµÐ· `markdown-it-py` (ÑƒÐ¶Ðµ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÑÑ…)
- Score Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ: `f"{score:.4f}"`, >0.02 Ð·ÐµÐ»Ñ‘Ð½Ñ‹Ð¹, <0.01 ÑÐµÑ€Ñ‹Ð¹

**Ð—Ð°Ð´Ð°Ñ‡Ð¸:**

1. **HTMX ÐŸÐ¾Ð¸ÑÐº:**
    - Input Ñ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€Ð¾Ð¼ `keyup changed delay:500ms`.
    - Ð”Ð¸Ð½Ð°Ð¼Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð±Ð»Ð¾ÐºÐ° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸.
2. **Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ (Facets):**
    - Ð¡Ð°Ð¹Ð´Ð±Ð°Ñ€ Ñ Ñ‡ÐµÐºÐ±Ð¾ÐºÑÐ°Ð¼Ð¸: "Ð¢Ð¸Ð¿ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°" (Text, Code, Image, Audio).
    - Ð¡Ð°Ð¹Ð´Ð±Ð°Ñ€ Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸/Ñ‚ÐµÐ³Ð°Ð¼Ð¸ (Ð°Ð³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ñ Ð¸Ð· Ð‘Ð”).
3. **Ð ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²:**
    - ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°: Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº, Ð¡Ð½Ð¸Ð¿Ð¿ÐµÑ‚, Ð¢ÐµÐ³Ð¸, Score (Ñ Ñ†Ð²ÐµÑ‚Ð¾Ð²Ð¾Ð¹ ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²ÐºÐ¾Ð¹).
    - ÐŸÐ¾Ð´ÑÐ²ÐµÑ‚ÐºÐ° ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸ÑÐ° (Highlight.js) Ð´Ð»Ñ Ñ‡Ð°Ð½ÐºÐ¾Ð² Ñ‚Ð¸Ð¿Ð° `CODE`.
    - Markdown-to-HTML ÐºÐ¾Ð½Ð²ÐµÑ€Ñ‚ÐµÑ€ Ð´Ð»Ñ Ñ‚ÐµÐºÑÑ‚Ð°.
4. **Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€:**
    - Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð° (render full markdown).
    - Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð¼ÐµÐ´Ð¸Ð°-Ð¾Ð±ÑŠÐµÐºÑ‚Ð°.

**Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (12.2):**

- `test_search_routes.py`: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° RRF, Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ñ‚Ð¸Ð¿Ñƒ.
- `test_render.py`: Markdown Ð¿Ñ€ÐµÐ²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ Ð² Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹ HTML.

---

### ðŸ“¦ 12.3: Content Management (Ingest UI)

**Ð¦ÐµÐ»ÑŒ:** Ð£Ð´Ð¾Ð±Ð½Ð°Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð°Ð¼Ð¸.

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ:**

- Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ: `uploads/` Ñ UUID-Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ñ„Ð°Ð¹Ð»Ð¾Ð²
- Sync/Async Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸: <5 Ñ„Ð°Ð¹Ð»Ð¾Ð² â†’ Sync, â‰¥5 â†’ Async

**Ð—Ð°Ð´Ð°Ñ‡Ð¸:**

1. **Drag-n-Drop Upload:**
    - Ð¤Ð¾Ñ€Ð¼Ð° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ (Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ multiple files).
    - ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¿Ð°Ñ€: `doc.md` + `image.png`.
2. **Backend Ingest:**
    - Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð² `uploads/` Ñ UUID-Ð¿Ñ€ÐµÑ„Ð¸ÐºÑÐ°Ð¼Ð¸.
    - ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿ÑƒÑ‚ÐµÐ¹ Ð² MD Ð¿ÐµÑ€ÐµÐ´ ingest'Ð¾Ð¼.
    - Ð’Ñ‹Ð·Ð¾Ð² `core.ingest()` (Sync/Async Ð¿Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ Ñ„Ð°Ð¹Ð»Ð¾Ð²).
3. **Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ð¼Ð¸:**
    - Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð² (Data Table).
    - ÐšÐ½Ð¾Ð¿ÐºÐ¸: "ÐŸÐµÑ€ÐµÐ¸Ð½Ð´ÐµÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ", "Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ".
    - Ð¡Ñ‚Ð°Ñ‚ÑƒÑ "Async Processing" (Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€, ÐµÑÐ»Ð¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚ Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸).

**Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (12.3):**

- `test_upload_flow.py`: Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° MD+IMG ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ñ‡Ð°Ð½ÐºÐ¸.
- `test_delete_flow.py`: Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð° Ñ‡Ð¸ÑÑ‚Ð¸Ñ‚ Ð¸ Ð²ÐµÐºÑ‚Ð¾Ñ€Ð½Ñ‹Ð¹ Ð¸Ð½Ð´ÐµÐºÑ, Ð¸ FTS.

---

### ðŸ“¦ 12.4: RAG Chat Interface (Ð˜Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²)

**Ð¦ÐµÐ»ÑŒ:** Ð§Ð°Ñ‚ Ñ Ð±Ð°Ð·Ð¾Ð¹ Ð·Ð½Ð°Ð½Ð¸Ð¹ Ð² Ð²ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐµ.

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ:**

- Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ñ‡Ð°Ñ‚Ð°: SQLite Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° `chat_sessions` (Ð² Ñ‚Ð¾Ð¹ Ð¶Ðµ Ð‘Ð”)
- Ð‘ÐµÐ· streaming: ÑÐ¿Ð¸Ð½Ð½ÐµÑ€ "ÐŸÐµÑ‡Ð°Ñ‚Ð°ÐµÑ‚..." + Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚

**Ð—Ð°Ð´Ð°Ñ‡Ð¸:**

1. **UI Ð§Ð°Ñ‚Ð°:**
    - ÐžÐºÐ½Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ (Ð¿ÑƒÐ·Ñ‹Ñ€Ð¸).
    - Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ "ÐŸÐµÑ‡Ð°Ñ‚Ð°ÐµÑ‚..." (HTMX swap, Ð±ÐµÐ· WebSocket/SSE).
2. **Session Management:**
    - ÐœÐ¾Ð´ÐµÐ»ÑŒ `ChatSession` (Peewee) Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸.
    - Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ `ChatHistoryManager` Ð¸Ð· Ð¤Ð°Ð·Ñ‹ 9.1.
3. **RAG Pipeline Integration:**
    - ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ° â†’ ÐŸÐ¾Ð¸ÑÐº (Ñ ÐºÑÑˆÐµÐ¼) â†’ Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ â†’ ÐžÑ‚Ð²ÐµÑ‚.
    - Ð ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³ ÑÑÑ‹Ð»Ð¾Ðº Ð½Ð° Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸ (`[1]`) ÐºÐ°Ðº ÐºÐ»Ð¸ÐºÐ°Ð±ÐµÐ»ÑŒÐ½Ñ‹Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð².

**Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (12.4):**

- `test_chat_flow.py`: Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ, ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð¿ÐµÑ€ÐµÐ´Ð°ÐµÑ‚ÑÑ.
- `test_source_linking.py`: Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸ Ð² Ð¾Ñ‚Ð²ÐµÑ‚Ðµ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð¼Ð°Ñ‚Ñ‡Ð°Ñ‚ÑÑ Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ð¼Ð¸.

---

### ðŸ“¦ 12.5: Polish & Deployment (Ð¤Ð¸Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ)

**Ð¦ÐµÐ»ÑŒ:** Ð”Ð¾Ð²ÐµÑÑ‚Ð¸ Ð´Ð¾ ÑƒÐ¼Ð° UI/UX Ð¸ Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÑŒ Ðº Ð·Ð°Ð¿ÑƒÑÐºÑƒ.

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ:**

- Worker: Ñ‚Ñ€ÐµÐ´ Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾ (`flask run --with-threads`), `systemd` Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°
- Ð¢ÐµÑÑ‚Ñ‹: `pytest-flask`

**Ð—Ð°Ð´Ð°Ñ‡Ð¸:**

1. **Error Handling:** ÐšÑ€Ð°ÑÐ¸Ð²Ñ‹Ðµ Ñ‚Ð¾ÑÑ‚Ñ‹ (Notifications) Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ… API Ð¸Ð»Ð¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸.
2. **Queue Monitor:** Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° `/admin/queue` Ñ Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð²Ð¾Ñ€ÐºÐµÑ€Ð° (Ð¸Ð· Ð¤Ð°Ð·Ñ‹ 8.1).
3. **Worker Integration:** ÐšÐ½Ð¾Ð¿ÐºÐ° "Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð²Ð¾Ñ€ÐºÐµÑ€" (Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾Ð¼ Ñ‚Ñ€ÐµÐ´Ðµ Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾) Ð¸Ð»Ð¸ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ Ð¿Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÑƒ.
4. **Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð³Ð¾Ð½:** E2E Ñ‚ÐµÑÑ‚ Ð²ÑÐµÐ³Ð¾ Ñ†Ð¸ÐºÐ»Ð° (Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ð» â†’ ÐÐ°ÑˆÐµÐ» â†’ Ð¡Ð¿Ñ€Ð¾ÑÐ¸Ð» Ð² Ñ‡Ð°Ñ‚Ðµ).

**Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (12.5):**

- `test_e2e_full_cycle.py`: Ð¡Ñ†ÐµÐ½Ð°Ñ€Ð¸Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ (pytest-flask).

---

### Ð ÐµÑÑƒÑ€ÑÑ‹ Ð´Ð»Ñ ÐÐ³ÐµÐ½Ñ‚Ð° (Context)

- **Models:** Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð¸Ð· `semantic_core`.
- **Config:** Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ `SemanticConfig` (Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚: env â†’ `semantic.toml`).
- **Logging:** Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ `get_logger("flask_app")` + `setup_logging()`.
- **Core DI:** `current_app.extensions['semantic_core']` â€” ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñ‹Ð¹ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½ Flask.
- **HTMX:** Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½ "Active Search" Ð¸ "Lazy Loading".
- **Ð¢ÐµÑÑ‚Ñ‹:** `pytest-flask` Ñ Ñ„Ð¸ÐºÑÑ‚ÑƒÑ€Ð°Ð¼Ð¸ `client`, `app`.
