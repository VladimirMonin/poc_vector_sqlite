# Phase 12.1: Critical Bug Fixes (Flask App)

**–°—Ç–∞—Ç—É—Å:** IN PROGRESS  
**–¶–µ–ª—å:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏, –∏–∑-–∑–∞ –∫–æ—Ç–æ—Ä—ã—Ö Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

## üìã –ó–∞–¥–∞—á–∏

### 1. ‚úÖ Fix Dashboard Quick Actions (DONE)

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢—Ä–∏ –∫–Ω–æ–ø–∫–∏ –Ω–∞ Dashboard –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç (href="#").

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–µ–Ω—ã `href="#"` –Ω–∞ `url_for()`:

- –ü–æ–∏—Å–∫ ‚Üí `{{ url_for('search.index') }}`
- –ó–∞–≥—Ä—É–∑–∏—Ç—å ‚Üí `{{ url_for('ingest.upload_page') }}`
- RAG-—á–∞—Ç ‚Üí `{{ url_for('chat.index') }}`

---

### 2. ‚úÖ Fix Sidebar Dead Links (DONE)

**–ü—Ä–æ–±–ª–µ–º–∞:** "–ú–µ–¥–∏–∞" –∏ "–û—á–µ—Ä–µ–¥—å" –≤–µ–¥—É—Ç –≤ –Ω–∏–∫—É–¥–∞.

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ "Soon" —Å `disabled` –∫–ª–∞—Å—Å–æ–º.

---

### 3. ‚úÖ Fix Image Ingestion (DONE)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å, –Ω–æ –Ω–µ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–ª–∏—Å—å.

**–†–µ—à–µ–Ω–∏–µ:**

- `ingest_image()` —Å–æ–∑–¥–∞—ë—Ç Document + Chunk —Å `ChunkType.IMAGE_REF`
- –î–æ–±–∞–≤–ª–µ–Ω `title` –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- –≠–º–±–µ–¥–¥–∏–Ω–≥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

---

### 4. üîß Fix Audio/Video Ingestion (TODO)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê—É–¥–∏–æ –∏ –≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è, –Ω–æ –ù–ï –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è.

**–ü—Ä–∏—á–∏–Ω–∞:** –í `ingest.py:117-131` –Ω–µ—Ç `AUDIO_EXTENSIONS` –∏ `VIDEO_EXTENSIONS`, –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è `core.ingest_audio()` / `core.ingest_video()`.

**–ó–∞–¥–∞—á–∏:**

- [ ] –î–æ–±–∞–≤–∏—Ç—å `AUDIO_EXTENSIONS = {".mp3", ".wav", ".ogg", ".m4a", ".flac"}`
- [ ] –î–æ–±–∞–≤–∏—Ç—å `VIDEO_EXTENSIONS = {".mp4", ".webm", ".mov", ".avi"}`
- [ ] –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–∫–∏ `audio_files` –∏ `video_files`
- [ ] –í—ã–∑—ã–≤–∞—Ç—å `core.ingest_audio()` –∏ `core.ingest_video()`
- [ ] –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–ª—É—á–∞–π –∫–æ–≥–¥–∞ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**–§–∞–π–ª—ã:**

- `app/routes/ingest.py`

---

### 5. üîß Fix Image Title in Metadata (TODO)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞—Ä—Ç–∏–Ω–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ "–î–æ–∫—É–º–µ–Ω—Ç #123" –≤–º–µ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è.

**–ü—Ä–∏—á–∏–Ω–∞:** –í `pipeline.py:407-417` –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç `title`.

**–ó–∞–¥–∞—á–∏:**

- [ ] –î–æ–±–∞–≤–∏—Ç—å `"title": Path(path).stem.replace("_", " ").title()` –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- [ ] –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `result.alt_text` –∫–∞–∫ title

**–§–∞–π–ª—ã:**

- `semantic_core/pipeline.py`

---

### 6. üîß Fix Document Detail View (TODO)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** Route `GET /documents/<id>` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

**–ó–∞–¥–∞—á–∏:**

- [ ] –°–æ–∑–¥–∞—Ç—å route `/documents/<int:doc_id>` –≤ `ingest.py`
- [ ] –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω `document_detail.html`
- [ ] –ü–æ–∫–∞–∑–∞—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- [ ] –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —á–∞–Ω–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—Å—ã–ª–∫–∏ –≤ `search_results.html`

**–§–∞–π–ª—ã:**

- `app/routes/ingest.py`
- `app/templates/document_detail.html` (–Ω–æ–≤—ã–π)
- `app/templates/partials/search_results.html`

---

### 7. üîß Fix Chat Interface (TODO)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ß–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –°–æ–æ–±—â–µ–Ω–∏–µ –∏—Å—á–µ–∑–∞–µ—Ç, –æ—Ç–≤–µ—Ç–∞ –Ω–µ—Ç.

**–ó–∞–¥–∞—á–∏:**

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç `/chat/send`
- [ ] –î–æ–±–∞–≤–∏—Ç—å try/except —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å HTMX –∞—Ç—Ä–∏–±—É—Ç—ã
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `RAGEngine` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

**–§–∞–π–ª—ã:**

- `app/routes/chat.py`
- `app/templates/chat.html`
- `app/services/chat_service.py`

---

### 8. ‚ö†Ô∏è FTS Search for Chunks NOT IMPLEMENTED

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–∏—Å–∫ "—Å–∞–Ω—Ç–∞" –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–æ –∫–æ–¥–∏–Ω–≥ (similarity 0.71).

**–ü—Ä–∏—á–∏–Ω–∞:** –í `adapter.py:666-678` FTS –¥–ª—è —á–∞–Ω–∫–æ–≤ **–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω**.
–ü—Ä–∏ `hybrid` —Ä–µ–∂–∏–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**.

```python
if mode == "fts":
    # FTS –¥–ª—è —á–∞–Ω–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
    results = []
elif mode == "hybrid":
    # –¢–æ–ª—å–∫–æ –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫!
    results = self._vector_search_chunks(...)
```

**–°—Ç–∞—Ç—É—Å:** DEFERRED (—Å–ª–æ–∂–Ω–∞—è –∑–∞–¥–∞—á–∞, –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ Phase 12.3)

---

### 9. üìù Small Chunks by Design

**–ü—Ä–æ–±–ª–µ–º–∞:** –ß–∞–Ω–∫–∏ –ø–æ 20-50 —Å–∏–º–≤–æ–ª–æ–≤.

**–ü—Ä–∏—á–∏–Ω–∞:** SmartSplitter —Å–æ–∑–¥–∞—ë—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π —á–∞–Ω–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ–¥–∏–∞-—ç–ª–µ–º–µ–Ω—Ç–∞ (image, code block).
–≠—Ç–æ **by design** –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ retrieval.

**–°—Ç–∞—Ç—É—Å:** NOT A BUG ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —á–∞–Ω–∫–∏ ~1000 —Å–∏–º–≤–æ–ª–æ–≤, –º–µ–¥–∏–∞-—Å—Å—ã–ª–∫–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã.

---

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å

| # | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|---|--------|--------|
| 1 | Dashboard Quick Actions | ‚úÖ DONE |
| 2 | Sidebar Dead Links | ‚úÖ DONE |
| 3 | Image Ingestion | ‚úÖ DONE |
| 4 | Audio/Video Ingestion | üîß TODO |
| 5 | Image Title | üîß TODO |
| 6 | Document Detail View | üîß TODO |
| 7 | Chat Interface | üîß TODO |
| 8 | FTS for Chunks | ‚ö†Ô∏è DEFERRED |
| 9 | Small Chunks | üìù NOT A BUG |

---

## üß™ –¢–µ—Å—Ç—ã

- [x] `test_pipeline_image.py` ‚Äî 10 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
- [x] `test_pipeline_audio_video.py` ‚Äî 6 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
- [ ] E2E —Ç–µ—Å—Ç—ã Flask app (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)
